

<!DOCTYPE html>
<!--[if IE 8]> <html class="ie8"> <![endif]-->
<!--[if IE 9]> <html class="ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html>
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  
  
  
  <title>Using Tekton Hub with OpenShift Pipelines | Custom Tekton Hub instance | Red Hat OpenShift Pipelines Branch Build</title>
  <link href="https://assets.openshift.net/content/subdomain.css" rel="stylesheet" type="text/css"/>
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/search.css" rel="stylesheet" media="screen"/>
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/autumn.css" rel="stylesheet"  media="screen"/>
  <link href="https://assets.openshift.net/content/subdomain/touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" type="image/png"/>
  <link href="https://assets.openshift.net/content/subdomain/favicon32x32.png" rel="shortcut icon" type="text/css"/>
  <link href="https://assets.openshift.net/content/osh-nav-footer.css" rel="stylesheet" type="text/css" media="screen"/>
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/docs.css" rel="stylesheet"  media="screen"/>
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/print.css" rel="stylesheet" type="text/css" media="print"/>
  <!--[if IE]><link rel="shortcut icon" href="https://assets.openshift.net/content/subdomain/favicon.ico"><![endif]-->
  <!-- or, set /favicon.ico for IE10 win -->
  <meta content="OpenShift" name="application-name">
  <meta content="#000000" name="msapplication-TileColor">
  <meta content="https://assets.openshift.net/content/subdomain/touch-icon-precomposed.png" name="msapplication-TileImage">

  <!-- Adobe DTM -->
  <script src="//www.redhat.com/dtm.js" type="text/javascript"></script>
  <!-- End Adobe DTM -->

  <script id="trustarc" src="https://static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"
        rel="stylesheet">

</head>

<body onload="selectVersion('Branch Build');">
  
<nav id="main">
  <div class="container">
    <div class="row">
      <div class="navbar navbar-default navbar-openshift" role="navigation">
        <div class="navbar-header">
            <a href="#nav-main" class="dropdown-toggle navbar-menu-toggle hidden visible-xs" data-toggle="collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </a>
          <a class="navbar-brand" href="/"></a>
        </div>
        <div id="nav-main" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li id="products" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="true">
                Products <span class="fa fa-angle-down"></span>
              </a>
              <div class="dropdown-menu">
                <div class="row flex-column flex-md-row">
                  <div class="col-xs-12 col-sm-3">
                    <h3>Overview</h3>
                    <ul class="nav flex-column">
                      <li><a target="_blank" href="https://www.openshift.com/products/features/">Features</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/products/pricing/">Pricing</a></li>
                    </ul>
                  </div>
                  <div class="col-xs-12 col-sm-9">
                    <h3>Featured Products</h3>
                    <ul class="nav">
                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/container-platform/">Red Hat OpenShift Container&nbsp;Platform</a>
                        <p class="d-none d-md-block">Build, deploy and manage your applications across cloud- and on-premise infrastructure</p>
                      </li>
                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/dedicated/">Red Hat OpenShift Dedicated</a>
                        <p class="d-none d-md-block">Single-tenant, high-availability Kubernetes clusters in the public cloud</p>
                      </li>

                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/online/">Red Hat OpenShift Online</a>
                        <p class="d-none d-md-block">The fastest way for developers to build, host and scale applications in the public cloud</p>
                      </li>

                      <li class="nav-item">
                        <a target="_blank" href="https://www.openshift.com/products/">All products <span class="fa fa-angle-right"></span></a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </li>

            <li id="learn" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Learn <span class="fa fa-angle-down"></span>
              </a>
              <div class="dropdown-menu">
                <div class="row flex-md-nowrap">
                  <div class="col-xs-12 col-sm-6">
                    <h3>Learn</h3>
                    <ul class="nav">
                      <li><a target="_blank" href="https://www.openshift.com/learn/what-is-openshift/">What is OpenShift</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/get-started/">Get started</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/partners/">Partners</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/success-stories/">Customer success stories</a></li>
                      <li><a target="_blank" href="https://blog.openshift.com">Blog</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/resources/">Resources</a></li>
                    </ul>
                  </div>
                  <div class="col-xs-12 col-sm-6">
                    <h3>Technology Topics</h3>
                    <ul class="nav">
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/knative/">Knative</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/security/">Security</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/kubernetes/">Kubernetes</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/service-brokers/">Service Brokers</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Community <span class="fa fa-angle-down"></span>
              </a>
              <ul class="dropdown-menu">
                <li><a target="_blank" href="https://commons.openshift.org">OpenShift Commons</a></li>
                <li><a target="_blank" href="https://www.okd.io">Open Source (OKD)</a></li>
                <li><a target="_blank" href="https://www.openshift.com/community/programs/startups/">Startups</a></li>
                <li><a target="_blank" href="https://www.openshift.com/community/programs/grants/">Grants</a></li>
              </ul>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Support <span class="fa fa-angle-down"></span>
              </a>
              <ul class="dropdown-menu">
                <li><a target="_blank" href="https://help.openshift.com">Help Center</a></li>
                <li><a href="https://docs.openshift.com">OpenShift Docs</a></li>
              </ul>
            </li>

            <li><a target="_blank" class="nav-sign-up" href="https://www.openshift.com/trial/">Free Trial</a></li>

            <li><a target="_blank" href="https://console.redhat.com/openshift" class="nav-sign-in">Log In <span class="fa fa-angle-right"></span></a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</nav>

  
  <div class="container">
    <button id="hc-open-btn" class="open-btn-sm" onclick="openNav()" aria-label="Open"><span class="fa fa-bars" /></button>
    <ol class="breadcrumb hide-for-print">
      

      

      

      

      

      

      <li class="sitename">
        <a href="/">
          Documentation</a>
      </li>
      <li class="hidden-xs active">
        
          <a href="../about/op-release-notes.html">Red Hat OpenShift Pipelines Branch Build</a>
        
      </li>
      <li class="hidden-xs active">
        <a href="../hub/using-tekton-hub-with-openshift-pipelines.html">Custom Tekton Hub instance</a>
      </li>
      
      
      <li class="hidden-xs active">
        Using Tekton Hub with OpenShift Pipelines
      </li>
      
      <span text-align="right" style="float: right !important">
        <a href="https://github.com/openshift/openshift-docs/commits/main/hub/using-tekton-hub-with-openshift-pipelines.adoc"><span class="material-icons-outlined" title="Page history">history</span></a>
        
        <a href="https://issues.redhat.com/secure/CreateIssueDetails!init.jspa?pid=12332330&issuetype=1&components=12367614&priority=4&summary=Issue+in+file+hub/using-tekton-hub-with-openshift-pipelines.adoc">
          <span class="material-icons-outlined" title="Open an issue">bug_report</span>
        </a>
        <a href="javascript: void(0);" onclick="window.print()"><span class="material-icons-outlined" title="Print page (Save as PDF)">picture_as_pdf</span></a>
        
        
      </span>
      
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas hide-for-print">
        <div class="row-fluid">
          <div id="btn-close">
            <button id="hc-close-btn" onclick="closeNav()" class="close-btn-sm" aria-label="close"><span class="fa fa-times" /></button>
          </div>
          <div id="hc-search">
            <input id="hc-search-input" type="text" aria-label="search">
            <button id="hc-search-btn" aria-label="search"><span class="fa fa-search" /></button>
          </div>
        </div>
        <ul class="nav nav-sidebar">
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup0"><span id="tgSpan0" class="fa fa-angle-right"></span>About OpenShift Pipelines</a>
      <ul id="topicGroup0" class="collapse  list-unstyled">
            <li><a class="" href="../about/op-release-notes.html">OpenShift Pipelines release notes</a></li>
            <li><a class="" href="../about/about-pipelines.html">About OpenShift Pipelines</a></li>
            <li><a class="" href="../about/understanding-openshift-pipelines.html">Understanding OpenShift Pipelines</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup1"><span id="tgSpan1" class="fa fa-angle-right"></span>Installing and configuring</a>
      <ul id="topicGroup1" class="collapse  list-unstyled">
            <li><a class="" href="../install_config/installing-pipelines.html">Installing OpenShift Pipelines</a></li>
            <li><a class="" href="../install_config/uninstalling-pipelines.html">Uninstalling OpenShift Pipelines</a></li>
            <li><a class="" href="../install_config/customizing-configurations-in-the-tektonconfig-cr.html">Customizing configurations in the TektonConfig custom resource</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup2"><span id="tgSpan2" class="fa fa-angle-right"></span>Managing resource use</a>
      <ul id="topicGroup2" class="collapse  list-unstyled">
            <li><a class="" href="../resource/reducing-pipelines-resource-consumption.html">Reducing resource consumption of OpenShift Pipelines</a></li>
            <li><a class="" href="../resource/setting-compute-resource-quota-for-openshift-pipelines.html">Setting compute resource quota for OpenShift Pipelines</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup3"><span id="tgSpan3" class="fa fa-angle-right"></span>Creating CI/CD pipelines</a>
      <ul id="topicGroup3" class="collapse  list-unstyled">
            <li><a class="" href="../create/creating-applications-with-cicd-pipelines.html">Creating CI/CD solutions for applications using OpenShift Pipelines</a></li>
            <li><a class="" href="../create/working-with-pipelines-web-console.html">Working with OpenShift Pipelines in the web console</a></li>
            <li><a class="" href="../create/remote-pipelines-tasks-resolvers.html">Specifying remote pipelines and tasks using resolvers</a></li>
            <li><a class="" href="../create/managing-nonversioned-and-versioned-cluster-tasks.html">Managing non-versioned and versioned cluster tasks</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup4"><span id="tgSpan4" class="fa fa-angle-right"></span>Observability in OpenShift Pipelines</a>
      <ul id="topicGroup4" class="collapse  list-unstyled">
            <li><a class="" href="../records/using-tekton-results-for-openshift-pipelines-observability.html">Using Tekton Results for OpenShift Pipelines observability</a></li>
            <li><a class="" href="../records/viewing-pipeline-logs-using-the-openshift-logging-operator.html">Viewing pipeline logs using the OpenShift Logging Operator</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup5"><span id="tgSpan5" class="fa fa-angle-right"></span>Pipelines as Code</a>
      <ul id="topicGroup5" class="collapse  list-unstyled">
            <li><a class="" href="../pac/about-pipelines-as-code.html">About Pipelines as Code</a></li>
            <li><a class="" href="../pac/install-config-pipelines-as-code.html">Installing and configuring Pipelines as Code</a></li>
            <li><a class="" href="../pac/using-pipelines-as-code-repos.html">Using Pipelines as Code with a Git repository hosting service provider</a></li>
            <li><a class="" href="../pac/using-repository-crd.html">Using the Repository custom resource</a></li>
            <li><a class="" href="../pac/using-pac-resolver.html">Using the Pipelines as Code resolver</a></li>
            <li><a class="" href="../pac/managing-pipeline-runs-pac.html">Managing pipeline runs</a></li>
            <li><a class="" href="../pac/pac-command-reference.html">Pipelines as Code command reference</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup6"><span id="tgSpan6" class="fa fa-angle-right"></span>Securing OpenShift Pipelines</a>
      <ul id="topicGroup6" class="collapse  list-unstyled">
            <li><a class="" href="../secure/using-tekton-chains-for-openshift-pipelines-supply-chain-security.html">Using Tekton Chains for OpenShift Pipelines supply chain security</a></li>
            <li><a class="" href="../secure/configuring-security-context-for-pods.html">Configuring the security context for pods</a></li>
            <li><a class="" href="../secure/securing-webhooks-with-event-listeners.html">Securing webhooks with event listeners</a></li>
            <li><a class="" href="../secure/authenticating-pipelines-using-git-secret.html">Authenticating pipelines using git secret</a></li>
            <li><a class="" href="../secure/unprivileged-building-of-container-images-using-buildah.html">Unprivileged building of container images using Buildah</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup7"><span id="tgSpan7" class="fa fa-angle-down"></span>Custom Tekton Hub instance</a>
      <ul id="topicGroup7" class="collapse in list-unstyled">
            <li><a class=" active" href="../hub/using-tekton-hub-with-openshift-pipelines.html">Using Tekton Hub with OpenShift Pipelines</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup8"><span id="tgSpan8" class="fa fa-angle-right"></span>Pipelines CLI (tkn) reference</a>
      <ul id="topicGroup8" class="collapse  list-unstyled">
            <li><a class="" href="../tkn_cli/installing-tkn.html">Installing tkn</a></li>
            <li><a class="" href="../tkn_cli/op-configuring-tkn.html">Configuring tkn</a></li>
            <li><a class="" href="../tkn_cli/op-tkn-reference.html">Basic tkn commands</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div id="hc-search-modal">
        <div id="hc-modal-content">
          <span id="hc-modal-close">&times;</span>
          <div id="hc-search-results-wrapper">
            <div id="hc-search-results"></div>
            <div id="hc-search-progress-indicator" class="text-center search-progress-indicator"><i class="fa fa-circle-o-notch fa-spin" style="font-size:42px"></i></div>
            <div class="text-center">
              <button id="hc-search-more-btn">Show more results</button>
            </div>
          </div>
        </div>
      </div>
      <div class="print-logo" style="display:none;">
        <img src="https://www.redhat.com/cms/managed-files/Logo-Red_Hat-OpenShift-A-Standard-RGB_0_0.svg" alt="print logo"/>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h1>
            Using Tekton Hub with OpenShift Pipelines
          </h1>
        </div>
        
        
        <div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title"></div>
<ul class="sectlevel1">
<li><a href="#installing-and-deploying-tekton-hub-on-an-openshift-cluster_using-tekton-hub-with-openshift-pipelines">Installing and deploying Tekton Hub on a OpenShift Container Platform cluster</a>
<ul class="sectlevel2">
<li><a href="#installing-tekton-hub-without-login-and-rating.adoc_using-tekton-hub-with-openshift-pipelines">Installing Tekton Hub without login and rating</a></li>
<li><a href="#installing-tekton-hub-with-login-and-rating_using-tekton-hub-with-openshift-pipelines">Installing Tekton Hub with login and rating</a></li>
</ul>
</li>
<li><a href="#using-a-custom-database-in-tekton-hub_using-tekton-hub-with-openshift-pipelines">Optional: Using a custom database in Tekton Hub</a>
<ul class="sectlevel2">
<li><a href="#installing-crunchy-postgres-database-and-tekton-hub_using-tekton-hub-with-openshift-pipelines">Optional: Installing Crunchy Postgres database and Tekton Hub</a></li>
<li><a href="#migrating-tekton-hub-data-to-an-existing-crunchy-postgres-database_using-tekton-hub-with-openshift-pipelines">Optional: Migrating Tekton Hub data to an existing Crunchy Postgres database</a></li>
</ul>
</li>
<li><a href="#updating-tekton-hub-with-custom-categories-and-catalogs_using-tekton-hub-with-openshift-pipelines">Updating Tekton Hub with custom categories and catalogs</a></li>
<li><a href="#modifying-catalog-refresh-interval-tekton-hub_using-tekton-hub-with-openshift-pipelines">Modifying the catalog refresh interval of Tekton Hub</a></li>
<li><a href="#adding-new-users-in-tekton-hub-configuration_using-tekton-hub-with-openshift-pipelines">Adding new users in Tekton Hub configuration</a></li>
<li><a href="#disabling-tekton-hub-authorization-after-upgrade.adoc_using-tekton-hub-with-openshift-pipelines">Disabling Tekton Hub authorization after upgrading the Red Hat OpenShift Pipelines Operator from 1.7 to 1.8</a></li>
<li><a href="#additional-resources-tekton-hub">Additional resources</a></li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Tekton Hub is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.</p>
</div>
<div class="paragraph">
<p>For more information about the support scope of Red Hat Technology Preview features, see <a href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph _abstract">
<p>Tekton Hub helps you discover, search, and share reusable tasks and pipelines for your CI/CD workflows. A public instance of Tekton Hub is available at <a href="https://hub.tekton.dev/">hub.tekton.dev</a>. Cluster administrators can also install and deploy a custom instance of Tekton Hub by modifying the configurations in the <code>TektonHub</code> custom resource (CR).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installing-and-deploying-tekton-hub-on-an-openshift-cluster_using-tekton-hub-with-openshift-pipelines"><a class="anchor" href="#installing-and-deploying-tekton-hub-on-an-openshift-cluster_using-tekton-hub-with-openshift-pipelines"></a>Installing and deploying Tekton Hub on a OpenShift Container Platform cluster</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Tekton Hub is an optional component; cluster administrators cannot install it using the <code>TektonConfig</code> custom resource (CR). To install and manage Tekton Hub, use the <code>TektonHub</code> CR.</p>
</div>
<div class="paragraph">
<p>You can install Tekton Hub on your cluster using two modes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Without</em> login authorization and ratings for Tekton Hub artifacts</p>
</li>
<li>
<p><em>with</em> login authorization and ratings for Tekton Hub artifacts</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are using Github Enterprise or Gitlab Enterprise, install and deploy Tekton Hub in the same network as the enterprise server. For example, if the enterprise server is running behind a VPN, deploy Tekton Hub on a cluster that is also behind the VPN.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="installing-tekton-hub-without-login-and-rating.adoc_using-tekton-hub-with-openshift-pipelines"><a class="anchor" href="#installing-tekton-hub-without-login-and-rating.adoc_using-tekton-hub-with-openshift-pipelines"></a>Installing Tekton Hub without login and rating</h3>
<div class="paragraph _abstract">
<p>You can install Tekton Hub on your cluster automatically with default configuration. When using the default configuration, Tekton Hub does not support login with authorization and ratings for Tekton Hub artifacts.</p>
</div>
<div class="ulist discrete">
<div class="title">Prerequisites</div>
<ul class="discrete">
<li>
<p>Ensure that the Red Hat OpenShift Pipelines Operator is installed in the default <code>openshift-pipelines</code> namespace on the cluster.</p>
</li>
</ul>
</div>
<div class="olist discrete">
<div class="title">Procedure</div>
<ol class="discrete">
<li>
<p>Create a <code>TektonHub</code> CR similar to the following example.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">operator.tekton.dev/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">TektonHub</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">hub</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">targetNamespace</span><span class="pi">:</span> <span class="s">openshift-pipelines</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="na">db</span><span class="pi">:</span>                      <span class="c1"># Optional: If you want to use custom database</span>
    <span class="na">secret</span><span class="pi">:</span> <span class="s">tekton-hub-db</span>  <span class="c1"># Name of db secret should be `tekton-hub-db`</span>

  <span class="na">categories</span><span class="pi">:</span>              <span class="c1"># Optional: If you want to use custom categories</span>
    <span class="pi">-</span> <span class="s">Automation</span>
    <span class="pi">-</span> <span class="s">Build Tools</span>
    <span class="pi">-</span> <span class="s">CLI</span>
    <span class="pi">-</span> <span class="s">Cloud</span>
    <span class="pi">-</span> <span class="s">Code Quality</span>
    <span class="pi">-</span> <span class="s">...</span>

  <span class="na">catalogs</span><span class="pi">:</span>                <span class="c1"># Optional: If you want to use custom catalogs</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">tekton</span>
      <span class="na">org</span><span class="pi">:</span> <span class="s">tektoncd</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">community</span>
      <span class="na">provider</span><span class="pi">:</span> <span class="s">github</span>
      <span class="na">url</span><span class="pi">:</span> <span class="s">https://github.com/tektoncd/catalog</span>
      <span class="na">revision</span><span class="pi">:</span> <span class="s">main</span>

  <span class="na">scopes</span><span class="pi">:</span>                   <span class="c1"># Optional: If you want to add new users</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">agent:create</span>
      <span class="na">users</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">abc</span><span class="pi">,</span> <span class="nv">qwe</span><span class="pi">,</span> <span class="nv">pqr</span><span class="pi">]</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">catalog:refresh</span>
      <span class="na">users</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">abc</span><span class="pi">,</span> <span class="nv">qwe</span><span class="pi">,</span> <span class="nv">pqr</span><span class="pi">]</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">config:refresh</span>
      <span class="na">users</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">abc</span><span class="pi">,</span> <span class="nv">qwe</span><span class="pi">,</span> <span class="nv">pqr</span><span class="pi">]</span>

  <span class="na">default</span><span class="pi">:</span>                   <span class="c1"># Optional: If you want to add custom default scopes</span>
    <span class="na">scopes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">rating:read</span>
      <span class="pi">-</span> <span class="s">rating:write</span>

  <span class="na">api</span><span class="pi">:</span>
    <span class="na">catalogRefreshInterval</span><span class="pi">:</span> <span class="s">30m</span> <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The namespace in which Tekton Hub must be installed; default is <code>openshift-pipelines</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The time interval after which the catalog refreshes automatically. The supported units of time are seconds (<code>s</code>), minutes (<code>m</code>), hours (<code>h</code>), days (<code>d</code>), and weeks (<code>w</code>). The default interval is 30 minutes.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you don&#8217;t provide custom values for the optional fields in the <code>TektonHub</code> CR, the default values configured in the Tekton Hub API config map is used.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Apply the <code>TektonHub</code> CR.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc apply <span class="nt">-f</span> &lt;tekton-hub-cr&gt;.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Check the status of the installation. The <code>TektonHub</code> CR might take some time to attain steady state.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get tektonhub.operator.tekton.dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sample output</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="go">NAME   VERSION   READY   REASON   APIURL                    UIURL
hub    v1.9.0    True             https://api.route.url/    https://ui.route.url/</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="installing-tekton-hub-with-login-and-rating_using-tekton-hub-with-openshift-pipelines"><a class="anchor" href="#installing-tekton-hub-with-login-and-rating_using-tekton-hub-with-openshift-pipelines"></a>Installing Tekton Hub with login and rating</h3>
<div class="paragraph _abstract">
<p>You can install Tekton Hub on your cluster with custom configuration that supports login with authorization and ratings for Tekton Hub artifacts.</p>
</div>
<div class="ulist discrete">
<div class="title">Prerequisites</div>
<ul class="discrete">
<li>
<p>Ensure that the Red Hat OpenShift Pipelines Operator is installed in the default <code>openshift-pipelines</code> namespace on the cluster.</p>
</li>
</ul>
</div>
<div class="olist discrete">
<div class="title">Procedure</div>
<ol class="discrete">
<li>
<p>Create an OAuth application with your Git repository hosting provider, and note the Client ID and Client Secret. The supported providers are GitHub, GitLab, and BitBucket.</p>
<div class="ulist">
<ul>
<li>
<p>For a <a href="https://docs.github.com/en/developers/apps/creating-an-oauth-app">GitHub OAuth application</a>, set the Homepage URL and the Authorization callback URL as <code>&lt;auth-route&gt;</code>.</p>
</li>
<li>
<p>For a <a href="https://docs.gitlab.com/ee/integration/oauth_provider.html#user-owned-applications">GitLab OAuth application</a>, set the <code>REDIRECT_URI</code> as <code>&lt;auth-route&gt;/auth/gitlab/callback</code>.</p>
</li>
<li>
<p>For a <a href="https://support.atlassian.com/bitbucket-cloud/docs/use-oauth-on-bitbucket-cloud">BitBucket OAuth application</a>, set the <code>Callback URL</code> as <code>&lt;auth-route&gt;</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Edit the <code>&lt;tekton_hub_root&gt;/config/02-api/20-api-secret.yaml</code> file to include the Tekton Hub API secrets. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Secret</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">tekton-hub-api</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">openshift-pipelines</span>
<span class="na">type</span><span class="pi">:</span> <span class="s">Opaque</span>
<span class="na">stringData</span><span class="pi">:</span>
  <span class="na">GH_CLIENT_ID</span><span class="pi">:</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="na">GH_CLIENT_SECRET</span><span class="pi">:</span> <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="na">GL_CLIENT_ID</span><span class="pi">:</span> <i class="conum" data-value="3"></i><b>(3)</b>
  <span class="na">GL_CLIENT_SECRET</span><span class="pi">:</span> <i class="conum" data-value="4"></i><b>(4)</b>
  <span class="na">BB_CLIENT_ID</span><span class="pi">:</span> <i class="conum" data-value="5"></i><b>(5)</b>
  <span class="na">BB_CLIENT_SECRET</span><span class="pi">:</span> <i class="conum" data-value="6"></i><b>(6)</b>
  <span class="na">JWT_SIGNING_KEY</span><span class="pi">:</span> <i class="conum" data-value="7"></i><b>(7)</b>
  <span class="na">ACCESS_JWT_EXPIRES_IN</span><span class="pi">:</span> <i class="conum" data-value="8"></i><b>(8)</b>
  <span class="na">REFRESH_JWT_EXPIRES_IN</span><span class="pi">:</span> <i class="conum" data-value="9"></i><b>(9)</b>
  <span class="na">AUTH_BASE_URL</span><span class="pi">:</span> <i class="conum" data-value="10"></i><b>(10)</b>
  <span class="na">GHE_URL</span><span class="pi">:</span> <i class="conum" data-value="11"></i><b>(11)</b>
  <span class="na">GLE_URL</span><span class="pi">:</span> <i class="conum" data-value="12"></i><b>(12)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The Client ID from the GitHub OAuth application.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The Client Secret from the GitHub OAuth application.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The Client ID from the GitLab OAuth application.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The Client Secret from the GitLab OAuth application.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The Client ID from the BitBucket OAuth application.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The Client Secret from the BitBucket OAuth application.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>A long, random string used to sign the JSON Web Token (JWT) created for users.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Add the time limit after which the access token expires. For example, <code>1m</code>, where m denotes minutes. The supported units of time are seconds (<code>s</code>), minutes (<code>m</code>), hours (<code>h</code>), days (<code>d</code>), and weeks (<code>w</code>).</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>Add the time limit after which the refresh token expires. For example, <code>1m</code>, where <code>m</code> denotes minutes. The supported units of time are seconds (<code>s</code>), minutes (<code>m</code>), hours (<code>h</code>), days (<code>d</code>), and weeks (<code>w</code>). Ensure that the expiry time set for token refresh is greater than the expiry time set for token access.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Route URL for the OAuth application.</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>GitHub Enterprise URL, if you are authenticating using GitHub Enterprise. Do not provide the URL to the catalog as a value for this field.</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>GitLab Enterprise URL, if you are authenticating using GitLab Enterprise. Do not provide the URL to the catalog as a value for this field.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can delete the unused fields for the Git repository hosting service providers that are irrelevant to your deployment.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Create a <code>TektonHub</code> CR similar to the following example.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">operator.tekton.dev/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">TektonHub</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">hub</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">targetNamespace</span><span class="pi">:</span> <span class="s">openshift-pipelines</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="na">db</span><span class="pi">:</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="na">secret</span><span class="pi">:</span> <span class="s">tekton-hub-db</span> <i class="conum" data-value="3"></i><b>(3)</b>

  <span class="na">categories</span><span class="pi">:</span> <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="pi">-</span> <span class="s">Automation</span>
    <span class="pi">-</span> <span class="s">Build Tools</span>
    <span class="pi">-</span> <span class="s">CLI</span>
    <span class="pi">-</span> <span class="s">Cloud</span>
    <span class="pi">-</span> <span class="s">Code Quality</span>
      <span class="s">...</span>

  <span class="na">catalogs</span><span class="pi">:</span> <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">tekton</span>
      <span class="na">org</span><span class="pi">:</span> <span class="s">tektoncd</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">community</span>
      <span class="na">provider</span><span class="pi">:</span> <span class="s">github</span>
      <span class="na">url</span><span class="pi">:</span> <span class="s">https://github.com/tektoncd/catalog</span>
      <span class="na">revision</span><span class="pi">:</span> <span class="s">main</span>

  <span class="na">scopes</span><span class="pi">:</span> <i class="conum" data-value="6"></i><b>(6)</b>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">agent:create</span>
      <span class="na">users</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">&lt;username&gt;</span><span class="pi">]</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">catalog:refresh</span>
      <span class="na">users</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">&lt;username&gt;</span><span class="pi">]</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">config:refresh</span>
      <span class="na">users</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">&lt;username&gt;</span><span class="pi">]</span>

  <span class="na">default</span><span class="pi">:</span> <i class="conum" data-value="7"></i><b>(7)</b>
    <span class="na">scopes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">rating:read</span>
      <span class="pi">-</span> <span class="s">rating:write</span>

  <span class="na">api</span><span class="pi">:</span>
    <span class="na">catalogRefreshInterval</span><span class="pi">:</span> <span class="s">30m</span> <i class="conum" data-value="8"></i><b>(8)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The namespace in which Tekton Hub must be installed; default is <code>openshift-pipelines</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Optional: Custom database, such as a Crunchy Postgres database.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The name of the database secret must be <code>tekton-hub-db</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Optional: Customized categories for tasks and pipelines in Tekton Hub.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Optional: Customized catalogs for Tekton Hub.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Optional: Additional users. You can metion multiple users, such as <code>[&lt;username_1&gt;, &lt;username_2&gt;, &lt;username_3&gt;]</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Optional: Customized default scopes.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>The time interval after which the catalog refreshes automatically. The supported units of time are seconds (<code>s</code>), minutes (<code>m</code>), hours (<code>h</code>), days (<code>d</code>), and weeks (<code>w</code>). The default interval is 30 minutes.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you don&#8217;t provide custom values for the optional fields in the <code>TektonHub</code> CR, the default values configured in the Tekton Hub API config map is used.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Apply the <code>TektonHub</code> CR.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc apply <span class="nt">-f</span> &lt;tekton-hub-cr&gt;.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Check the status of the installation. The <code>TektonHub</code> CR might take some time to attain steady state.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get tektonhub.operator.tekton.dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sample output</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="go">NAME   VERSION   READY   REASON   APIURL                    UIURL
hub    v1.9.0    True             https://api.route.url/    https://ui.route.url/</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-a-custom-database-in-tekton-hub_using-tekton-hub-with-openshift-pipelines"><a class="anchor" href="#using-a-custom-database-in-tekton-hub_using-tekton-hub-with-openshift-pipelines"></a>Optional: Using a custom database in Tekton Hub</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Cluster administrators can use a custom database with Tekton Hub, instead of the default PostgreSQL database installed by the Operator. You can associate a custom database at the time of installation, and use it with the <code>db-migration</code>, <code>api</code>, and <code>ui</code> interfaces provided by Tekton Hub. Alternatively, you can associate a custom database with Tekton Hub even after the installation with the default database is complete.</p>
</div>
<div class="olist discrete">
<div class="title">Procedure</div>
<ol class="discrete">
<li>
<p>Create a secret named <code>tekton-hub-db</code> in the target namespace with the following keys:</p>
<div class="ulist">
<ul>
<li>
<p><code>POSTGRES_HOST</code></p>
</li>
<li>
<p><code>POSTGRES_DB</code></p>
</li>
<li>
<p><code>POSTGRES_USER</code></p>
</li>
<li>
<p><code>POSTGRES_PASSWORD</code></p>
</li>
<li>
<p><code>POSTGRES_PORT</code></p>
<div class="listingblock">
<div class="title">Example: Custom database secrets</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Secret</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">tekton-hub-db</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">tekton-hub-db</span>
<span class="na">type</span><span class="pi">:</span> <span class="s">Opaque</span>
<span class="na">stringData</span><span class="pi">:</span>
  <span class="na">POSTGRES_HOST</span><span class="pi">:</span> <span class="s">&lt;The name of the host of the database&gt;</span>
  <span class="na">POSTGRES_DB</span><span class="pi">:</span> <span class="s">&lt;Name of the database&gt;</span>
  <span class="na">POSTGRES_USER</span><span class="pi">:</span> <span class="s">&lt;username&gt;</span>
  <span class="na">POSTGRES_PASSWORD</span><span class="pi">:</span> <span class="s">&lt;password&gt;</span>
  <span class="na">POSTGRES_PORT</span><span class="pi">:</span> <span class="s">&lt;The port that the database is listening on&gt;</span>
<span class="nn">...</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The default target namespace is <code>openshift-pipelines</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In the <code>TektonHub</code> CR, set the value of the database secret attribute to <code>tekton-hub-db</code>.</p>
<div class="listingblock">
<div class="title">Example: Adding custom database secret</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">operator.tekton.dev/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">TektonHub</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">hub</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">targetNamespace</span><span class="pi">:</span> <span class="s">openshift-pipelines</span>
  <span class="na">db</span><span class="pi">:</span>
    <span class="na">secret</span><span class="pi">:</span> <span class="s">tekton-hub-db</span>
  <span class="na">api</span><span class="pi">:</span>
    <span class="na">hubConfigUrl</span><span class="pi">:</span> <span class="s">https://raw.githubusercontent.com/tektoncd/hub/main/config.yaml</span>
    <span class="na">catalogRefreshInterval</span><span class="pi">:</span> <span class="s">30m</span>
<span class="nn">...</span></code></pre>
</div>
</div>
</li>
<li>
<p>Use the updated <code>TektonHub</code> CR to associate the custom database with Tekton Hub.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If you are associating the custom database at the time of installing Tekton Hub on your cluster, apply the updated <code>TektonHub</code> CR.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc apply <span class="nt">-f</span> &lt;tekton-hub-cr&gt;.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Alternatively, if you are associating the custom database after the installation of Tekton Hub is complete, replace the existing <code>TektonHub</code> CR with the updated <code>TektonHub</code> CR.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc replace <span class="nt">-f</span> &lt;tekton-hub-cr&gt;.yaml</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Check the status of the installation. The <code>TektonHub</code> CR might take some time to attain steady state.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get tektonhub.operator.tekton.dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sample output</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="go">NAME   VERSION   READY   REASON   APIURL                    UIURL
hub    v1.9.0    True             https://api.route.url/    https://ui.route.url/</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="installing-crunchy-postgres-database-and-tekton-hub_using-tekton-hub-with-openshift-pipelines"><a class="anchor" href="#installing-crunchy-postgres-database-and-tekton-hub_using-tekton-hub-with-openshift-pipelines"></a>Optional: Installing Crunchy Postgres database and Tekton Hub</h3>
<div class="paragraph _abstract">
<p>Cluster administrators can install the Crunchy Postgres database and configure Tekton Hub to use it instead of the default database.</p>
</div>
<div class="ulist discrete">
<div class="title">Prerequisites</div>
<ul class="discrete">
<li>
<p>Install the Crunchy Postgres Operator from the Operator Hub.</p>
</li>
<li>
<p>Create a Postgres instance that initiates a Crunchy Postgres database.</p>
</li>
</ul>
</div>
<div class="olist discrete">
<div class="title">Procedure</div>
<ol class="discrete">
<li>
<p>Get into the Crunchy Postgres pod.</p>
<div class="listingblock">
<div class="title">Example: Getting into the <code>test-instance1-m7hh-0</code> pod</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc <span class="nb">exec</span> <span class="nt">-it</span> <span class="nt">-n</span> openshift-operators test-instance1-m7hh-0 <span class="nt">--</span> /bin/sh
<span class="go">
Defaulting container name to database.
Use 'oc describe pod/test-instance1-m7hh-0 -n openshift-operators' to see all of the containers in this pod.
</span><span class="gp">sh-4.4$</span><span class="w"> </span>psql <span class="nt">-U</span> postgres
<span class="go">psql (14.4)
Type "help" for help.</span></code></pre>
</div>
</div>
</li>
<li>
<p>Find the <code>pg_hba.conf</code> file.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">postgres=#</span><span class="w"> </span>SHOW hba_file<span class="p">;</span>
<span class="go">         hba_file
--------------------------
 /pgdata/pg14/pg_hba.conf
(1 row)

</span><span class="gp">postgres=#</span></code></pre>
</div>
</div>
</li>
<li>
<p>Exit from the database.</p>
</li>
<li>
<p>Check if the <code>pg_hba.conf</code> file has the entry <code>host all all 0.0.0.0/0 md5</code>, required to access all incoming connections. In addition, add the entry at the end of the <code>pg_hba.conf</code> file.</p>
<div class="listingblock">
<div class="title">Example: <code>pg_hba.conf</code> file</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">sh-4.4$</span><span class="w"> </span><span class="nb">cat</span> /pgdata/pg14/pg_hba.conf
<span class="go">
</span><span class="gp">#</span><span class="w"> </span>Do not edit this file manually!
<span class="gp">#</span><span class="w"> </span>It will be overwritten by Patroni!
<span class="go">local all "postgres" peer
hostssl replication "_crunchyrepl" all cert
hostssl "postgres" "_crunchyrepl" all cert
host all "_crunchyrepl" all reject
hostssl all all all md5
host  all  all 0.0.0.0/0 md5</span></code></pre>
</div>
</div>
</li>
<li>
<p>Save the <code>pg_hba.conf</code> file and reload the database.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">sh-4.4$</span><span class="w"> </span>psql <span class="nt">-U</span> postgres
<span class="go">psql (14.4)
Type "help" for help.

</span><span class="gp">postgres=#</span><span class="w"> </span>SHOW hba_file<span class="p">;</span>
<span class="go">         hba_file
--------------------------
 /pgdata/pg14/pg_hba.conf
(1 row)

</span><span class="gp">postgres=#</span><span class="w"> </span>SELECT pg_reload_conf<span class="o">()</span><span class="p">;</span>
<span class="go"> pg_reload_conf
----------------
 t
(1 row)</span></code></pre>
</div>
</div>
</li>
<li>
<p>Exit the database.</p>
</li>
<li>
<p>Decode the secret value of the Crunchy Postgres host.</p>
<div class="listingblock">
<div class="title">Example: Decode the secret value of a Crunchy Postgres host</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="s1">'aGlwcG8tcHJpbWFyeS5vcGVuc2hpZnQtb3BlcmF0b3JzLnN2YyA='</span> | <span class="nb">base64</span> <span class="nt">--decode</span>
<span class="go">test-primary.openshift-operators.svc</span></code></pre>
</div>
</div>
</li>
<li>
<p>Create a secret named <code>tekton-hub-db</code> in the target namespace with the following keys:</p>
<div class="ulist">
<ul>
<li>
<p><code>POSTGRES_HOST</code></p>
</li>
<li>
<p><code>POSTGRES_DB</code></p>
</li>
<li>
<p><code>POSTGRES_USER</code></p>
</li>
<li>
<p><code>POSTGRES_PASSWORD</code></p>
</li>
<li>
<p><code>POSTGRES_PORT</code></p>
<div class="listingblock">
<div class="title">Example: Custom database secrets</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Secret</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">tekton-hub-db</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">tekton-hub-db</span>
<span class="na">type</span><span class="pi">:</span> <span class="s">Opaque</span>
<span class="na">stringData</span><span class="pi">:</span>
  <span class="na">POSTGRES_HOST</span><span class="pi">:</span> <span class="s">test-primary.openshift-operators.svc</span>
  <span class="na">POSTGRES_DB</span><span class="pi">:</span> <span class="s">test</span>
  <span class="na">POSTGRES_USER</span><span class="pi">:</span> <span class="s">&lt;username&gt;</span>
  <span class="na">POSTGRES_PASSWORD</span><span class="pi">:</span> <span class="s">&lt;password&gt;</span>
  <span class="na">POSTGRES_PORT</span><span class="pi">:</span> <span class="s1">'</span><span class="s">5432'</span>
<span class="nn">...</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The default target namespace is <code>openshift-pipelines</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>In the <code>TektonHub</code> CR, set the value of the database secret attribute to <code>tekton-hub-db</code>.</p>
<div class="listingblock">
<div class="title">Example: Adding custom database secret</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">operator.tekton.dev/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">TektonHub</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">hub</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">targetNamespace</span><span class="pi">:</span> <span class="s">openshift-pipelines</span>
  <span class="na">db</span><span class="pi">:</span>
    <span class="na">secret</span><span class="pi">:</span> <span class="s">tekton-hub-db</span>
<span class="nn">...</span></code></pre>
</div>
</div>
</li>
<li>
<p>Use the updated <code>TektonHub</code> CR to associate the custom database with Tekton Hub.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc apply <span class="nt">-f</span> &lt;tekton-hub-cr&gt;.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Check the status of the installation. The <code>TektonHub</code> CR might take some time to attain a steady state.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get tektonhub.operator.tekton.dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sample output</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="go">NAME   VERSION   READY   REASON   APIURL                    UIURL
hub    v1.9.0    True             https://api.route.url/    https://ui.route.url/</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="migrating-tekton-hub-data-to-an-existing-crunchy-postgres-database_using-tekton-hub-with-openshift-pipelines"><a class="anchor" href="#migrating-tekton-hub-data-to-an-existing-crunchy-postgres-database_using-tekton-hub-with-openshift-pipelines"></a>Optional: Migrating Tekton Hub data to an existing Crunchy Postgres database</h3>
<div class="paragraph _abstract">
<p>Tekton Hub supports the use of Crunchy Postgres as a custom database. For a pre-installed Tekton Hub with default database, cluster administrators can use Crunchy Postgres as a custom database after migrating the Tekton Hub data from the internal or default database to the external Crunchy Postgres database.</p>
</div>
<div class="olist discrete">
<div class="title">Procedure</div>
<ol class="discrete">
<li>
<p>Dump the existing data from the internal or default database into a file in the pod.</p>
<div class="listingblock">
<div class="title">Example: Dump data</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>pg_dump <span class="nt">-Ft</span> <span class="nt">-h</span> localhost <span class="nt">-U</span> postgres hub <span class="nt">-f</span> /tmp/hub.dump</code></pre>
</div>
</div>
</li>
<li>
<p>Copy the file containing the data dump to your local system.</p>
<div class="listingblock">
<div class="title">Command format</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc <span class="nb">cp</span> <span class="nt">-n</span> &lt;namespace&gt; &lt;podName&gt;:&lt;path-to-hub.dump&gt; &lt;path-to-local-system&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc <span class="nb">cp</span> <span class="nt">-n</span> openshift-pipelines tekton-hub-db-7d6d888c67-p7mdr:/tmp/hub.dump /home/test_user/Downloads/hub.dump</code></pre>
</div>
</div>
</li>
<li>
<p>Copy the file that contains the data dump from the local system to the pod running the external Crunchy Postgres database.</p>
<div class="listingblock">
<div class="title">Command format</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc <span class="nb">cp</span> <span class="nt">-n</span> &lt;namespace&gt; &lt;path-to-local-system&gt; &lt;podName&gt;:&lt;path-to-hub.dump&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc <span class="nb">cp</span> <span class="nt">-n</span> openshift-operators /home/test_user/Downloads/hub.dump test-instance1-spnz-0:/tmp/hub.dump</code></pre>
</div>
</div>
</li>
<li>
<p>Restore the data in the Crunchy Postgres database.</p>
<div class="listingblock">
<div class="title">Command format</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>pg_restore <span class="nt">-d</span> &lt;database-name&gt; <span class="nt">-h</span> localhost <span class="nt">-U</span> postgres &lt;path-where-file-is-copied&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>pg_restore <span class="nt">-d</span> <span class="nb">test</span> <span class="nt">-h</span> localhost <span class="nt">-U</span> postgres /tmp/hub.dump</code></pre>
</div>
</div>
</li>
<li>
<p>Get into the Crunchy Postgres pod.
.Example: Get into the <code>test-instance1-m7hh-0</code> pod</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc <span class="nb">exec</span> <span class="nt">-it</span> <span class="nt">-n</span> openshift-operators test-instance1-m7hh-0 <span class="nt">--</span> /bin/sh
<span class="go">
Defaulting container name to database.
Use 'oc describe pod/test-instance1-m7hh-0 -n openshift-operators' to see all of the containers in this pod.
</span><span class="gp">sh-4.4$</span><span class="w"> </span>psql <span class="nt">-U</span> postgres
<span class="go">psql (14.4)
Type "help" for help.</span></code></pre>
</div>
</div>
</li>
<li>
<p>Find the <code>pg_hba.conf</code> file.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">postgres=#</span><span class="w"> </span>SHOW hba_file<span class="p">;</span>
<span class="go">         hba_file
--------------------------
 /pgdata/pg14/pg_hba.conf
(1 row)

</span><span class="gp">postgres=#</span></code></pre>
</div>
</div>
</li>
<li>
<p>Exit from the database.</p>
</li>
<li>
<p>Check if the <code>pg_hba.conf</code> file has the entry <code>host all all 0.0.0.0/0 md5</code>, which is necessary for accessing all incoming connections. If necessary, add the entry at the end of the <code>pg_hba.conf</code> file.</p>
<div class="listingblock">
<div class="title">Example: <code>pg_hba.conf</code> file</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">sh-4.4$</span><span class="w"> </span><span class="nb">cat</span> /pgdata/pg14/pg_hba.conf
<span class="go">
</span><span class="gp">#</span><span class="w"> </span>Do not edit this file manually!
<span class="gp">#</span><span class="w"> </span>It will be overwritten by Patroni!
<span class="go">local all "postgres" peer
hostssl replication "_crunchyrepl" all cert
hostssl "postgres" "_crunchyrepl" all cert
host all "_crunchyrepl" all reject
hostssl all all all md5
host  all  all 0.0.0.0/0 md5</span></code></pre>
</div>
</div>
</li>
<li>
<p>Save the <code>pg_hba.conf</code> file and reload the database.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">sh-4.4$</span><span class="w"> </span>psql <span class="nt">-U</span> postgres
<span class="go">psql (14.4)
Type "help" for help.

</span><span class="gp">postgres=#</span><span class="w"> </span>SHOW hba_file<span class="p">;</span>
<span class="go">         hba_file
--------------------------
 /pgdata/pg14/pg_hba.conf
(1 row)

</span><span class="gp">postgres=#</span><span class="w"> </span>SELECT pg_reload_conf<span class="o">()</span><span class="p">;</span>
<span class="go"> pg_reload_conf
----------------
 t
(1 row)</span></code></pre>
</div>
</div>
</li>
<li>
<p>Exit the database.</p>
</li>
<li>
<p>Verify that a secret named <code>tekton-hub-db</code> in the target namespace has the following keys:</p>
<div class="ulist">
<ul>
<li>
<p><code>POSTGRES_HOST</code></p>
</li>
<li>
<p><code>POSTGRES_DB</code></p>
</li>
<li>
<p><code>POSTGRES_USER</code></p>
</li>
<li>
<p><code>POSTGRES_PASSWORD</code></p>
</li>
<li>
<p><code>POSTGRES_PORT</code></p>
<div class="listingblock">
<div class="title">Example: Custom database secrets</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Secret</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">tekton-hub-db</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">tekton-hub-db</span>
<span class="na">type</span><span class="pi">:</span> <span class="s">Opaque</span>
<span class="na">stringData</span><span class="pi">:</span>
  <span class="na">POSTGRES_HOST</span><span class="pi">:</span> <span class="s">test-primary.openshift-operators.svc</span>
  <span class="na">POSTGRES_DB</span><span class="pi">:</span> <span class="s">test</span>
  <span class="na">POSTGRES_USER</span><span class="pi">:</span> <span class="s">test</span>
  <span class="na">POSTGRES_PASSWORD</span><span class="pi">:</span> <span class="s">woXOisU5&gt;ocJiTF7y{{;1[Q(</span>
  <span class="na">POSTGRES_PORT</span><span class="pi">:</span> <span class="s1">'</span><span class="s">5432'</span>
<span class="nn">...</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The value of the <code>POSTGRES_HOST</code> field is encoded as a secret. You can decode the value of the Crunchy Postgres host by using the following example.</p>
</div>
<div class="listingblock">
<div class="title">Example: Decode the secret value of a Crunchy Postgres host</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="s1">'aGlwcG8tcHJpbWFyeS5vcGVuc2hpZnQtb3BlcmF0b3JzLnN2YyA='</span> | <span class="nb">base64</span> <span class="nt">--decode</span>
<span class="go">test-primary.openshift-operators.svc</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Verify that in the <code>TektonHub</code> CR, the value of the database secret attribute is <code>tekton-hub-db</code>.</p>
<div class="listingblock">
<div class="title">Example: TektonHub CR with the name of the database secret</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">operator.tekton.dev/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">TektonHub</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">hub</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">targetNamespace</span><span class="pi">:</span> <span class="s">openshift-pipelines</span>
  <span class="na">db</span><span class="pi">:</span>
    <span class="na">secret</span><span class="pi">:</span> <span class="s">tekton-hub-db</span>
<span class="nn">...</span></code></pre>
</div>
</div>
</li>
<li>
<p>To associate the external Crunchy Postgres database with Tekton Hub, replace any existing <code>TektonHub</code> CR with the updated <code>TektonHub</code> CR.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc replace <span class="nt">-f</span> &lt;updated-tekton-hub-cr&gt;.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Check the status of the Tekton Hub. The updated <code>TektonHub</code> CR might take some time to attain a steady state.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get tektonhub.operator.tekton.dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sample output</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="go">NAME   VERSION   READY   REASON   APIURL                    UIURL
hub    v1.9.0    True             https://api.route.url/    https://ui.route.url/</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="updating-tekton-hub-with-custom-categories-and-catalogs_using-tekton-hub-with-openshift-pipelines"><a class="anchor" href="#updating-tekton-hub-with-custom-categories-and-catalogs_using-tekton-hub-with-openshift-pipelines"></a>Updating Tekton Hub with custom categories and catalogs</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Cluster administrators can update Tekton Hub with custom categories, catalogs, scopes, and default scopes that reflect the context of their organization.</p>
</div>
<div class="olist discrete">
<div class="title">Procedure</div>
<ol class="discrete">
<li>
<p>Optional: Edit the <code>categories</code>, <code>catalogs</code>, <code>scopes</code>, and <code>default:scopes</code> fields in the Tekton Hub CR.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The default information for categories, catalog, scopes, and default scopes are pulled from the Tekton Hub API config map. If you provide custom values in the <code>TektonHub</code> CR, it overrides the default values.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Apply the Tekton Hub CR.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc apply <span class="nt">-f</span> &lt;tekton-hub-cr&gt;.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Observe the Tekton Hub status.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get tektonhub.operator.tekton.dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sample output</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="go">NAME   VERSION   READY   REASON   APIURL                  UIURL
hub    v1.9.0    True             https://api.route.url   https://ui.route.url</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="modifying-catalog-refresh-interval-tekton-hub_using-tekton-hub-with-openshift-pipelines"><a class="anchor" href="#modifying-catalog-refresh-interval-tekton-hub_using-tekton-hub-with-openshift-pipelines"></a>Modifying the catalog refresh interval of Tekton Hub</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>The default catalog refresh interval for Tekton Hub is 30 minutes. Cluster administrators can modify the automatic catalog refresh interval by modifying the value of the <code>catalogRefreshInterval</code> field in the <code>TektonHub</code> CR.</p>
</div>
<div class="olist discrete">
<div class="title">Procedure</div>
<ol class="discrete">
<li>
<p>Modify the value of the <code>catalogRefreshInterval</code> field in the <code>TektonHub</code> CR.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">operator.tekton.dev/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">TektonHub</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">hub</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">targetNamespace</span><span class="pi">:</span> <span class="s">openshift-pipelines</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="na">api</span><span class="pi">:</span>
    <span class="na">catalogRefreshInterval</span><span class="pi">:</span> <span class="s">30m</span> <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The namespace where Tekton Hub is installed; default is <code>openshift-pipelines</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The time interval after which the catalog refreshes automatically. The supported units of time are seconds (<code>s</code>), minutes (<code>m</code>), hours (<code>h</code>), days (<code>d</code>), and weeks (<code>w</code>). The default interval is 30 minutes.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Apply the <code>TektonHub</code> CR.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc apply <span class="nt">-f</span> &lt;tekton-hub-cr&gt;.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Check the status of the installation. The <code>TektonHub</code> CR might take some time to attain steady state.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get tektonhub.operator.tekton.dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sample output</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="go">NAME   VERSION   READY   REASON   APIURL                    UIURL
hub    v1.9.0    True             https://api.route.url/    https://ui.route.url/</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-new-users-in-tekton-hub-configuration_using-tekton-hub-with-openshift-pipelines"><a class="anchor" href="#adding-new-users-in-tekton-hub-configuration_using-tekton-hub-with-openshift-pipelines"></a>Adding new users in Tekton Hub configuration</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Cluster administrators can add new users to Tekton Hub with different scopes.</p>
</div>
<div class="olist discrete">
<div class="title">Procedure</div>
<ol class="discrete">
<li>
<p>Modify the <code>TektonHub</code> CR to add new users with different scopes.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="nn">...</span>
<span class="na">scopes</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">agent:create</span>
    <span class="na">users</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">&lt;username_1&gt;</span><span class="pi">,</span> <span class="nv">&lt;username_2&gt;</span><span class="pi">]</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">catalog:refresh</span>
    <span class="na">users</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">&lt;username_3&gt;</span><span class="pi">,</span> <span class="nv">&lt;username_4&gt;</span><span class="pi">]</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">config:refresh</span>
    <span class="na">users</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">&lt;username_5&gt;</span><span class="pi">,</span> <span class="nv">&lt;username_6&gt;</span><span class="pi">]</span>

<span class="na">default</span><span class="pi">:</span>
  <span class="na">scopes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">rating:read</span>
    <span class="pi">-</span> <span class="s">rating:write</span>
<span class="nn">...</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The usernames registered with the Git repository hosting service provider.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A new user signing in to Tekton Hub for the first time will have only the default scope. To activate additional scopes, ensure the user&#8217;s username is added in the <code>scopes</code> field of the <code>TektonHub</code> CR.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Apply the updated <code>TektonHub</code> CR.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc apply <span class="nt">-f</span> &lt;tekton-hub-cr&gt;.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Check the status of the Tekton Hub. The updated <code>TektonHub</code> CR might take some time to attain a steady state.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get tektonhub.operator.tekton.dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sample output</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="go">NAME   VERSION   READY   REASON   APIURL                    UIURL
hub    v1.9.0    True             https://api.route.url/    https://ui.route.url/</span></code></pre>
</div>
</div>
</li>
<li>
<p>Refresh the configuration.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>curl <span class="nt">-X</span> POST <span class="nt">-H</span> <span class="s2">"Authorization: &lt;access-token&gt;"</span> <span class="se">\ </span><i class="conum" data-value="1"></i><b>(1)</b>
<span class="gp">    --header "Content-Type: application/json" \
    --data '{"force": true} \
    &lt;api-route&gt;</span>/system/config/refresh</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The JWT token.</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="disabling-tekton-hub-authorization-after-upgrade.adoc_using-tekton-hub-with-openshift-pipelines"><a class="anchor" href="#disabling-tekton-hub-authorization-after-upgrade.adoc_using-tekton-hub-with-openshift-pipelines"></a>Disabling Tekton Hub authorization after upgrading the Red Hat OpenShift Pipelines Operator from 1.7 to 1.8</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>When you install Tekton Hub with Red Hat OpenShift Pipelines Operator 1.8, the login authorization and ratings for the Tekton Hub artifacts are disabled for the default installation. However, when you upgrade the Operator from 1.7 to 1.8, the instance of the Tekton Hub on your cluster does not automatically disable the login authorization and ratings.</p>
</div>
<div class="paragraph">
<p>To disable login authorization and ratings for Tekton Hub after upgrading the Operator from 1.7 to 1.8, perform the steps in the following procedure.</p>
</div>
<div class="ulist discrete">
<div class="title">Prerequisites</div>
<ul class="discrete">
<li>
<p>Ensure that the Red Hat OpenShift Pipelines Operator is installed in the default <code>openshift-pipelines</code> namespace on the cluster.</p>
</li>
</ul>
</div>
<div class="olist discrete">
<div class="title">Procedure</div>
<ol class="discrete">
<li>
<p>Delete the existing Tekton Hub API secret that you created while manually installing Tekton Hub for Operator 1.7.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc delete secret tekton-hub-api <span class="nt">-n</span> &lt;targetNamespace&gt; <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The common namespace for the Tekton Hub API secret and the Tekton Hub CR. By default, the target namespace is <code>openshift-pipelines</code>.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Delete the <code>TektonInstallerSet</code> object for the Tekton Hub API.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get tektoninstallerset <span class="nt">-o</span> name | <span class="nb">grep </span>tekton-hub-api | xargs oc delete</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>After deletion, the Operator automatically creates a new Tekton Hub API installer set.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Wait and check the status of the Tekton Hub. Proceed to the next steps when the <code>READY</code> column displays <code>True</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get tektonhub hub</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sample output</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="go">NAME   VERSION        READY   REASON   APIURL                                                                                                  UIURL
hub    1.8.0          True             https://tekton-hub-api-openshift-pipelines.apps.example.com   https://tekton-hub-ui-openshift-pipelines.apps.example.com
</span></code></pre>
</div>
</div>
</li>
<li>
<p>Delete the <code>ConfigMap</code> object for the Tekton Hub UI.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc delete configmap tekton-hub-ui <span class="nt">-n</span> &lt;targetNamespace&gt; <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The common namespace for the Tekton Hub UI and the Tekton Hub CR. By default, the target namespace is <code>openshift-pipelines</code>.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Delete the <code>TektonInstallerSet</code> object for the Tekton Hub UI.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get tektoninstallerset <span class="nt">-o</span> name | <span class="nb">grep </span>tekton-hub-ui | xargs oc delete</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>After deletion, the Operator automatically creates a new Tekton Hub UI installer set.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Wait and check the status of the Tekton Hub. Proceed to the next steps when the <code>READY</code> column displays <code>True</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get tektonhub hub</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sample output</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="go">NAME   VERSION        READY   REASON   APIURL                                                                                                  UIURL
hub    1.8.0          True             https://tekton-hub-api-openshift-pipelines.apps.example.com   https://tekton-hub-ui-openshift-pipelines.apps.example.com
</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1 _additional-resources">
<h2 id="additional-resources-tekton-hub"><a class="anchor" href="#additional-resources-tekton-hub"></a>Additional resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>GitHub repository of <a href="https://github.com/tektoncd/hub">Tekton Hub</a></p>
</li>
<li>
<p><a href="../install_config/installing-pipelines.html#installing-pipelines">Installing OpenShift Pipelines</a></p>
</li>
<li>
<p><a href="../about/op-release-notes.html#op-release-notes">Red Hat OpenShift Pipelines release notes</a></p>
</li>
</ul>
</div>
</div>
</div>
      </div>
    </div>
  </div>
  <script src="https://assets.openshift.net/content/modernizr.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/subdomain.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/nav-tertiary.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/bootstrap-offcanvas.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/reformat-html.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/hc-search.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/page-loader.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/clipboard.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/collapsible.js" type="text/javascript"></script>
  <script>
  var dk = 'openshift-pipelines';
  var version = 'Branch Build';

  var distros = {
    'openshift-origin': ['docs_origin', version],
    // specific labels are used for OSD instead of the URL filter, due to its unusual URL structure; assume v4
    'openshift-dedicated': ['docs_dedicated_v4'],
    'openshift-online': ['docs_online', version],
    'openshift-enterprise': ['docs_cp', version],
    'openshift-aro' : ['docs_aro', version],
    'openshift-rosa' : ['docs_rosa'],
    'openshift-acs' : ['docs_acs', version],
    'openshift-serverless' : ['docs_serverless', version]
  };

  // only OSD v3 docs have the version variable specified
  if (dk == "openshift-dedicated" && version == "3") {
    distros['openshift-dedicated'] = ['docs_dedicated_v3']
  }

  distros[dk] ? hcSearchCategory.apply(null, distros[dk]) : hcSearchCategory("docs");
  </script>
  <script type="text/javascript">
  /*<![CDATA[*/
  $(document).ready(function() {
    $("[id^='topicGroup']").on('show.bs.collapse', function(event) {
      if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
        $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
      }
    });
    $("[id^='topicGroup']").on('hide.bs.collapse', function(event) {
      if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
        $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
      }
    });
    $("[id^='topicSubGroup']").on('show.bs.collapse', function() {
      $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });
    $("[id^='topicSubGroup']").on('hide.bs.collapse', function() {
      $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });
    $("[id^='topicSubSubGroup']").on('show.bs.collapse', function() {
      $(this).parent().find("[id^='ssgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });
    $("[id^='topicSubSubGroup']").on('hide.bs.collapse', function() {
      $(this).parent().find("[id^='ssgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });

    const collapsibleContent = document.getElementsByTagName("details");
    for (var i = 0; i < collapsibleContent.length; i++) {
      collapsibleContent[i].setAttribute("open", "");
    }

  });
  /*]]>*/
  </script>

  <footer id="rh">

    <div class="container">
        <div class="row">

            <div class="col-sm-2">
                <img src="https://assets.openshift.com/hubfs/images/logos/Logo-RedHat-A-Reverse-RGB.svg" class="img-fluid" alt="Red Hat" style="height: 30px;">
            </div>

            <div class="col-sm-3">
              <p class="text-nowrap">Copyright  2023 Red Hat, Inc.</p>
            </div>



            <div class="col">
                <nav class="nav">
                    <a target="_blank" href="https://www.redhat.com/en/about/privacy-policy" class="nav-link">Privacy statement</a>
                    <a target="_blank" href="https://www.openshift.com/legal/terms/" class="nav-link">Terms of use</a>
                    <a target="_blank" href="https://www.redhat.com/en/about/all-policies-guidelines" class="nav-link">All policies and guidelines</a>
                    <a id="teconsent"></a>
                </nav>
            </div>
        </div>
    </div>
</footer>
<div id="consent_blackbar" style="z-index: 100; position: fixed"></div>



<!-- Adobe DTM -->
<script type="text/javascript">
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
   _satellite.pageBottom();
}
</script>
<!-- End Adobe DTM -->

  <!-- adjust page css based on breadcrumb and/or resize -->
  <script type="text/javascript">
    window.addEventListener('DOMContentLoaded', () => {
      if ($(window).width() >= 1008) {
        adjustSide();
        adjustToc();
        adjustMain();
      }
    });

    window.addEventListener('resize', () => {
      if ($(window).width() >= 1008) {
        adjustSide();
        adjustToc();
        adjustMain();
      } else if ($(window).width() < 1008) {
        sidebar.classList.remove('wide');
        document.querySelector('#hc-search').classList.remove('wide');
        if (sidebar.classList.contains('open')) {
          sidebar.style.display = 'block';
        } else {
          sidebar.style.display = 'none';
        }
        document.querySelector('.main').style.paddingTop = '0px';
      }
    });

    function adjustSide() {
      sidebar.classList.add('wide');
      document.querySelector('#hc-search').classList.add('wide');
      sidebar.style.display = 'block';
      document.querySelector('.sidebar').style.top = parseInt((document.querySelector('.breadcrumb').offsetHeight + 125), 10) + "px";
      document.querySelector('#hc-search').style.top = parseInt((document.querySelector('.breadcrumb').offsetHeight + 95), 10) + "px";
    }

    function adjustToc() {
      if (document.querySelector('#toc') !== null) {
        document.querySelector('#toc').style.top = parseInt((document.querySelector('.breadcrumb').offsetHeight + 90), 10) + "px";
      }
    }

    function adjustMain() {
      document.querySelector('html').style.scrollPaddingTop = parseInt((document.querySelector('.breadcrumb').offsetHeight + 90), 10) + "px";
      document.querySelector('.main').style.paddingTop = parseInt((document.querySelector('.breadcrumb').offsetHeight - 70), 10) + "px";
    }

  </script>

  <!-- remove toc active class when page is loaded -->
  <script type="text/javascript">
    window.addEventListener('DOMContentLoaded', () => {
      var tocItems = $("#toc a");

      for (let i = 0; i < tocItems.length; i++) {
        tocItems[i].classList.remove("toc-active");
      }
    })
  </script>

  <!-- maintain sidebar scroll position between page loads -->
  <script type="text/javascript">
    let sidebar = document.querySelector(".sidebar");
    let scrolltop = localStorage.getItem("sidebar-scroll");

    if (scrolltop == null) {
      sidebar.scrollTop = parseInt(top, 10);
    }

    window.addEventListener("beforeunload", () => {
      localStorage.setItem("sidebar-scroll", sidebar.scrollTop);
    });

    window.addEventListener('load', () => {
      sidebar.scrollTo(0, scrolltop)
    })
  </script>

  <!-- open/close the nav -->
  <script type="text/javascript">
    function closeNav() {
      let sidebar = document.querySelector(".sidebar");
      sidebar.style.display = "none";
      sidebar.classList.remove('open');
    }

    function openNav() {
      let sidebar = document.querySelector(".sidebar");
      let hc_search = document.querySelector('#hc-search');
      sidebar.style.display = "block";
      sidebar.style.top = "0px";
      hc_search.style.top = 'unset';
      sidebar.classList.add('open');
    }
  </script>

  <!-- clear and add toc-active to clicked toc link -->
  <script type="text/javascript">
  $("#toc a").click(function() {
    var tocItems = $("#toc a");
    for (let i = 0; i < tocItems.length; i++) {
      tocItems[i].classList.remove("toc-active");
    }
    this.classList.add("toc-active");
  });
  </script>

  <!-- update active toc class when mouse scrolls -->
  <script type="text/javascript">
    window.addEventListener('DOMContentLoaded', () => {
      window.addEventListener("wheel", () => {

        const ioConfiguration = {
          "rootMargin": "-120px 0px -400px 0px",
          "threshold": 0
        };

        const observer = new IntersectionObserver(setCurrent, ioConfiguration, entries => {
          entries.forEach(entry => {
            var id = entry.target.getAttribute('id');
            //fight with js
            document.querySelector(`#toc li a[href="#${id}"]`).classList.remove('toc-active');
          });
        });

        //track all h1-4 headings that have an id
        document.querySelectorAll('.main h2[id], .main h3[id]').forEach((h) => {
          observer.observe(h);
        });

        //runs when the IntersectionObserver fires
        function setCurrent(e) {
          var allTocLinks = document.querySelectorAll("#toc li a");
          if (allTocLinks !== undefined) {
            e.map(i => {
              if (i.isIntersecting && i.intersectionRatio >= 1) {
                allTocLinks.forEach(link => link.classList.remove("toc-active"));
                document.querySelector(`#toc li a[href="#${i.target.id}"]`).classList.add('toc-active')
              }
            })
          }
        };

        //make clicked toc item active and stop IntersectionObserver
        $("#toc a").click(function() {
          //stop tracking all h1-4 headings that have an id
          document.querySelectorAll('.main h2[id], .main h3[id]').forEach((h) => {
            observer.unobserve(h);
          });
          var tocItems = $("#toc a");
          if (tocItems !== undefined) {
            for (let i = 0; i < tocItems.length; i++) {
              tocItems[i].classList.remove("toc-active");
            };
            this.classList.add("toc-active");
          }
        })
      })
    })
  </script>

  <!--handle page scroll top and bottom, add toc-active -->
  <script type="text/javascript">
    document.addEventListener('scroll', () => {
      //scroll to bottom
      if(document.documentElement.scrollHeight === window.pageYOffset + window.innerHeight) {
        var tocItems = $("#toc a");
        for (let i = 0; i < tocItems.length; i++) {
          tocItems[i].classList.remove("toc-active")
          };
          tocItems[tocItems.length - 1].classList.add("toc-active");
        };
      //scroll to top
      if(window.pageYOffset === 0) {
        var tocItems = $("#toc a");
        for (let i = 0; i < tocItems.length; i++) {
          tocItems[i].classList.remove("toc-active");
          };
          tocItems[0].classList.add("toc-active");
        };
      })
  </script>

  <!--adjust sidebar and toc when footer is displayed -->
  <script type="text/javascript">
    sidebar = document.querySelector('.sidebar')
    toc = document.querySelector('#toc')
    main = document.querySelector('.main')
    okd_footer = document.querySelector('.footer-origin-docs')

    //handle short pages
    if (window.innerHeight === document.documentElement.scrollHeight) {
      //sidebar
      if (sidebar !== null && okd_footer == null) {
        sidebar.style.marginBottom = "38px";
        main.style.marginBottom = "35px";
      };
      //okd sidebar
      if(sidebar !== null && okd_footer !== null) {
        sidebar.style.marginBottom = "176px";
        main.style.marginBottom = "135px";
      }
    };

    //handle scrolling pages
    document.addEventListener('scroll', () => {
      //scroll to bottom
      if ($(window).width() >= 1008) {
        if(sidebar !== null) {
          //pages with multiple toc entries
          if(document.documentElement.scrollHeight === window.pageYOffset + window.innerHeight) {
              //sidebar
              if (sidebar !== null && okd_footer == null){
                sidebar.style.marginBottom = "38px";
                main.style.marginBottom = "35px";
              };
              //toc
              if (toc !== null && okd_footer == null){
                toc.style.bottom = "35px";
              };
              //okd sidebar
              if(sidebar !== null && okd_footer !== null) {
                sidebar.style.marginBottom = "176px";
                main.style.marginBottom = "135px";
              };
              //okd toc
              if (toc !== null && okd_footer !== null){
                toc.style.bottom = "175px";
              };
            };
          if(document.documentElement.scrollHeight != window.pageYOffset + window.innerHeight) {
            sidebar.style.marginBottom = "0px";
            if (toc !== null) {
              toc.style.bottom = "0px";
            }
          }
        }
      }
    })
  </script>

  <!-- adjust alerts on mobile -->
  <script type="text/javascript">
    alert = document.querySelector('#support-alert')
    window.addEventListener("wheel", () => {
      if ($(window).width() < 1008) {
        //adjust alert
        if(window.pageYOffset > 0) {
          if(alert !== null) {
            document.querySelector('#support-alert').style.position = "fixed";
            document.querySelector('#support-alert').style.bottom = "0px";
            document.querySelector('#support-alert').style.margin = "5px";
            document.querySelector('#support-alert').style.zIndex = "9999999";
          }
        }
      }
   });
    window.addEventListener('resize', () => {
      if ($(window).width() >= 1008) {
        if(alert !== null) {
          document.querySelector('#support-alert').style.removeProperty('position');
          document.querySelector('#support-alert').style.removeProperty('bottom');
          document.querySelector('#support-alert').style.removeProperty('margin');
          document.querySelector('#support-alert').style.removeProperty('zIndex');
        }
      }
    })
  </script>

</body>
</html>
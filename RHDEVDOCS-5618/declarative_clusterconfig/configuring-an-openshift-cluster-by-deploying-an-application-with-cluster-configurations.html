

<!DOCTYPE html>
<!--[if IE 8]> <html class="ie8"> <![endif]-->
<!--[if IE 9]> <html class="ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html>
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  
  
  
  <title>Configuring an OpenShift cluster by deploying an application with cluster configurations | Declarative cluster configuration | Red Hat OpenShift GitOps Branch Build</title>
  <link href="https://assets.openshift.net/content/subdomain.css" rel="stylesheet" type="text/css"/>
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/search.css" rel="stylesheet" media="screen"/>
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/autumn.css" rel="stylesheet"  media="screen"/>
  <link href="https://assets.openshift.net/content/subdomain/touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" type="image/png"/>
  <link href="https://assets.openshift.net/content/subdomain/favicon32x32.png" rel="shortcut icon" type="text/css"/>
  <link href="https://assets.openshift.net/content/osh-nav-footer.css" rel="stylesheet" type="text/css" media="screen"/>
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/docs.css" rel="stylesheet"  media="screen"/>
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/print.css" rel="stylesheet" type="text/css" media="print"/>
  <!--[if IE]><link rel="shortcut icon" href="https://assets.openshift.net/content/subdomain/favicon.ico"><![endif]-->
  <!-- or, set /favicon.ico for IE10 win -->
  <meta content="OpenShift" name="application-name">
  <meta content="#000000" name="msapplication-TileColor">
  <meta content="https://assets.openshift.net/content/subdomain/touch-icon-precomposed.png" name="msapplication-TileImage">

  <!-- Adobe DTM -->
  <script src="//www.redhat.com/dtm.js" type="text/javascript"></script>
  <!-- End Adobe DTM -->

  <script id="trustarc" src="https://static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"
        rel="stylesheet">

</head>

<body onload="selectVersion('Branch Build');">
  
<nav id="main">
  <div class="container">
    <div class="row">
      <div class="navbar navbar-default navbar-openshift" role="navigation">
        <div class="navbar-header">
            <a href="#nav-main" class="dropdown-toggle navbar-menu-toggle hidden visible-xs" data-toggle="collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </a>
          <a class="navbar-brand" href="/"></a>
        </div>
        <div id="nav-main" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li id="products" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="true">
                Products <span class="fa fa-angle-down"></span>
              </a>
              <div class="dropdown-menu">
                <div class="row flex-column flex-md-row">
                  <div class="col-xs-12 col-sm-3">
                    <h3>Overview</h3>
                    <ul class="nav flex-column">
                      <li><a target="_blank" href="https://www.openshift.com/products/features/">Features</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/products/pricing/">Pricing</a></li>
                    </ul>
                  </div>
                  <div class="col-xs-12 col-sm-9">
                    <h3>Featured Products</h3>
                    <ul class="nav">
                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/container-platform/">Red Hat OpenShift Container&nbsp;Platform</a>
                        <p class="d-none d-md-block">Build, deploy and manage your applications across cloud- and on-premise infrastructure</p>
                      </li>
                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/dedicated/">Red Hat OpenShift Dedicated</a>
                        <p class="d-none d-md-block">Single-tenant, high-availability Kubernetes clusters in the public cloud</p>
                      </li>

                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/online/">Red Hat OpenShift Online</a>
                        <p class="d-none d-md-block">The fastest way for developers to build, host and scale applications in the public cloud</p>
                      </li>

                      <li class="nav-item">
                        <a target="_blank" href="https://www.openshift.com/products/">All products <span class="fa fa-angle-right"></span></a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </li>

            <li id="learn" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Learn <span class="fa fa-angle-down"></span>
              </a>
              <div class="dropdown-menu">
                <div class="row flex-md-nowrap">
                  <div class="col-xs-12 col-sm-6">
                    <h3>Learn</h3>
                    <ul class="nav">
                      <li><a target="_blank" href="https://www.openshift.com/learn/what-is-openshift/">What is OpenShift</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/get-started/">Get started</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/partners/">Partners</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/success-stories/">Customer success stories</a></li>
                      <li><a target="_blank" href="https://blog.openshift.com">Blog</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/resources/">Resources</a></li>
                    </ul>
                  </div>
                  <div class="col-xs-12 col-sm-6">
                    <h3>Technology Topics</h3>
                    <ul class="nav">
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/knative/">Knative</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/security/">Security</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/kubernetes/">Kubernetes</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/service-brokers/">Service Brokers</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Community <span class="fa fa-angle-down"></span>
              </a>
              <ul class="dropdown-menu">
                <li><a target="_blank" href="https://commons.openshift.org">OpenShift Commons</a></li>
                <li><a target="_blank" href="https://www.okd.io">Open Source (OKD)</a></li>
                <li><a target="_blank" href="https://www.openshift.com/community/programs/startups/">Startups</a></li>
                <li><a target="_blank" href="https://www.openshift.com/community/programs/grants/">Grants</a></li>
              </ul>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Support <span class="fa fa-angle-down"></span>
              </a>
              <ul class="dropdown-menu">
                <li><a target="_blank" href="https://help.openshift.com">Help Center</a></li>
                <li><a href="https://docs.openshift.com">OpenShift Docs</a></li>
              </ul>
            </li>

            <li><a target="_blank" class="nav-sign-up" href="https://www.openshift.com/trial/">Free Trial</a></li>

            <li><a target="_blank" href="https://console.redhat.com/openshift" class="nav-sign-in">Log In <span class="fa fa-angle-right"></span></a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</nav>

  
  <div class="container">
    <button id="hc-open-btn" class="open-btn-sm" onclick="openNav()" aria-label="Open"><span class="fa fa-bars" /></button>
    <ol class="breadcrumb hide-for-print">
      

      

      

      

      

      

      <li class="sitename">
        <a href="/">
          Documentation</a>
      </li>
      <li class="hidden-xs active">
        
          <a href="../release_notes/gitops-release-notes.html">Red Hat OpenShift GitOps Branch Build</a>
        
      </li>
      <li class="hidden-xs active">
        <a href="../declarative_clusterconfig/configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations.html">Declarative cluster configuration</a>
      </li>
      
      
      <li class="hidden-xs active">
        Configuring an OpenShift cluster by deploying an application with cluster configurations
      </li>
      
      <span text-align="right" style="float: right !important">
        <a href="https://github.com/openshift/openshift-docs/commits/main/declarative_clusterconfig/configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations.adoc"><span class="material-icons-outlined" title="Page history">history</span></a>
        
        <a href="https://issues.redhat.com/secure/CreateIssueDetails!init.jspa?pid=12332330&issuetype=1&components=12367614&priority=4&summary=Issue+in+file+declarative_clusterconfig/configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations.adoc">
          <span class="material-icons-outlined" title="Open an issue">bug_report</span>
        </a>
        <a href="javascript: void(0);" onclick="window.print()"><span class="material-icons-outlined" title="Print page (Save as PDF)">picture_as_pdf</span></a>
        
        
      </span>
      
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas hide-for-print">
        <div class="row-fluid">
          <div id="btn-close">
            <button id="hc-close-btn" onclick="closeNav()" class="close-btn-sm" aria-label="close"><span class="fa fa-times" /></button>
          </div>
          <div id="hc-search">
            <input id="hc-search-input" type="text" aria-label="search">
            <button id="hc-search-btn" aria-label="search"><span class="fa fa-search" /></button>
          </div>
        </div>
        <ul class="nav nav-sidebar">
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup0"><span id="tgSpan0" class="fa fa-angle-right"></span>Release notes</a>
      <ul id="topicGroup0" class="collapse  list-unstyled">
            <li><a class="" href="../release_notes/gitops-release-notes.html">OpenShift GitOps release notes</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup1"><span id="tgSpan1" class="fa fa-angle-right"></span>Understanding OpenShift GitOps</a>
      <ul id="topicGroup1" class="collapse  list-unstyled">
            <li><a class="" href="../understanding_openshift_gitops/what-is-gitops.html">What is GitOps?</a></li>
            <li><a class="" href="../understanding_openshift_gitops/about-redhat-openshift-gitops.html">About OpenShift GitOps</a></li>
            <li><a class="" href="../understanding_openshift_gitops/gathering-gitops-diagnostic-information-for-support.html">Gathering diagnostic information for support</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup2"><span id="tgSpan2" class="fa fa-angle-right"></span>Installing GitOps</a>
      <ul id="topicGroup2" class="collapse  list-unstyled">
            <li><a class="" href="../installing_gitops/preparing-gitops-install.html">Preparing to install OpenShift GitOps</a></li>
            <li><a class="" href="../installing_gitops/installing-openshift-gitops.html">Installing OpenShift GitOps</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup3"><span id="tgSpan3" class="fa fa-angle-right"></span>Argo CD instance</a>
      <ul id="topicGroup3" class="collapse  list-unstyled">
            <li><a class="" href="../argocd_instance/setting-up-argocd-instance.html">Setting up a new Argo CD instance</a></li>
            <li><a class="" href="../argocd_instance/argo-cd-cr-component-properties.html">Argo CD custom resource and component properties</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup4"><span id="tgSpan4" class="fa fa-angle-right"></span>Access control and user management</a>
      <ul id="topicGroup4" class="collapse  list-unstyled">
            <li><a class="" href="../accesscontrol_usermanagement/configuring-argo-cd-rbac.html">Configuring Argo CD RBAC</a></li>
            <li><a class="" href="../accesscontrol_usermanagement/configuring-sso-on-argo-cd-using-dex.html">Configuring SSO for Argo CD using Dex</a></li>
            <li><a class="" href="../accesscontrol_usermanagement/configuring-sso-for-argo-cd-using-keycloak.html">Configuring SSO for Argo CD using Keycloak</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup5"><span id="tgSpan5" class="fa fa-angle-right"></span>Managing resource use</a>
      <ul id="topicGroup5" class="collapse  list-unstyled">
            <li><a class="" href="../managing_resource/configuring-resource-quota.html">Configuring Resource Quota</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup6"><span id="tgSpan6" class="fa fa-angle-right"></span>Argo CD applications</a>
      <ul id="topicGroup6" class="collapse  list-unstyled">
            <li><a class="" href="../argocd_applications/deploying-a-spring-boot-application-with-argo-cd.html">Deploying a Spring Boot application with Argo CD</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup7"><span id="tgSpan7" class="fa fa-angle-down"></span>Declarative cluster configuration</a>
      <ul id="topicGroup7" class="collapse in list-unstyled">
            <li><a class=" active" href="../declarative_clusterconfig/configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations.html">Configuring an OpenShift cluster by deploying an application with cluster configurations</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup8"><span id="tgSpan8" class="fa fa-angle-right"></span>Argo Rollouts</a>
      <ul id="topicGroup8" class="collapse  list-unstyled">
            <li><a class="" href="../argo_rollouts/using-argo-rollouts-for-progressive-deployment-delivery.html">Using Argo Rollouts for progressive deployment delivery</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup9"><span id="tgSpan9" class="fa fa-angle-right"></span>Security</a>
      <ul id="topicGroup9" class="collapse  list-unstyled">
            <li><a class="" href="../securing_openshift_gitops/configuring-secure-communication-with-redis.html">Configuring secure communication with Redis</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup10"><span id="tgSpan10" class="fa fa-angle-right"></span>Observability</a>
      <ul id="topicGroup10" class="collapse  list-unstyled">
            <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-10-0"><span id="sgSpan-10-0" class="fa fa-caret-right"></span>&nbsp;Logging</a>
              <ul id="topicSubGroup-10-0" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../observability/logging/viewing-argo-cd-logs.html">Viewing Argo CD logs</a></li>              </ul>
            </li>
            <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-10-1"><span id="sgSpan-10-1" class="fa fa-caret-right"></span>&nbsp;Monitoring</a>
              <ul id="topicSubGroup-10-1" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../observability/monitoring/monitoring-with-gitops-dashboards.html">Monitoring with GitOps dashboards</a></li>
                  <li><a class="" href="../observability/monitoring/monitoring-argo-cd-instances.html">Monitoring Argo CD instances</a></li>
                  <li><a class="" href="../observability/monitoring/monitoring-the-gitops-operator-performance.html">Monitoring the GitOps Operator performance</a></li>
                  <li><a class="" href="../observability/monitoring/health-information-for-resources-deployment.html">Monitoring application health status</a></li>
                  <li><a class="" href="../observability/monitoring/monitoring-argo-cd-custom-resource-workloads.html">Monitoring Argo CD custom resource workloads</a></li>              </ul>
            </li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup11"><span id="tgSpan11" class="fa fa-angle-right"></span>GitOps workloads on infrastructure nodes</a>
      <ul id="topicGroup11" class="collapse  list-unstyled">
            <li><a class="" href="../gitops_workloads_infranodes/run-gitops-control-plane-workload-on-infra-nodes.html">Running Control Plane Workloads on Infra nodes</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup12"><span id="tgSpan12" class="fa fa-angle-right"></span>Troubleshooting issues</a>
      <ul id="topicGroup12" class="collapse  list-unstyled">
            <li><a class="" href="../troubleshooting_gitops_issues/auto-reboot-during-argo-cd-sync-with-machine-configurations.html">Auto-reboot during Argo CD sync with machine configurations</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup13"><span id="tgSpan13" class="fa fa-angle-right"></span>Removing GitOps</a>
      <ul id="topicGroup13" class="collapse  list-unstyled">
            <li><a class="" href="../removing_gitops/uninstalling-openshift-gitops.html">Uninstalling OpenShift GitOps</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div id="hc-search-modal">
        <div id="hc-modal-content">
          <span id="hc-modal-close">&times;</span>
          <div id="hc-search-results-wrapper">
            <div id="hc-search-results"></div>
            <div id="hc-search-progress-indicator" class="text-center search-progress-indicator"><i class="fa fa-circle-o-notch fa-spin" style="font-size:42px"></i></div>
            <div class="text-center">
              <button id="hc-search-more-btn">Show more results</button>
            </div>
          </div>
        </div>
      </div>
      <div class="print-logo" style="display:none;">
        <img src="https://www.redhat.com/cms/managed-files/Logo-Red_Hat-OpenShift-A-Standard-RGB_0_0.svg" alt="print logo"/>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h1>
            Configuring an OpenShift cluster by deploying an application with cluster configurations
          </h1>
        </div>
        
        
        <div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title"></div>
<ul class="sectlevel1">
<li><a href="#prerequisites_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations">Prerequisites</a></li>
<li><a href="#using-argo-cd-instance-to-manage-cluster-scoped-resourcesconfiguring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations">Using an Argo CD instance to manage cluster-scoped resources</a></li>
<li><a href="#default-permissions-of-an-argocd-instance.adocconfiguring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations">Default permissions of an Argocd instance</a></li>
<li><a href="#run-argo-cd-instance-on-cluster_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations">Running the Argo CD instance at the cluster-level</a></li>
<li><a href="#creating-an-application-by-using-the-argo-cd-dashboard_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations">Creating an application by using the Argo CD dashboard</a></li>
<li><a href="#creating-an-application-by-using-the-oc-tool_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations">Creating an application by using the <code>oc</code> tool</a></li>
<li><a href="#synchronizing-your-application-application-with-your-git-repository_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations">Synchronizing your application with your Git repository</a></li>
<li><a href="#gitops-inbuilt-permissions-for-cluster-config_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations">In-built permissions for cluster configuration</a></li>
<li><a href="#gitops-additional-permissions-for-cluster-config_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations">Adding permissions for cluster configuration</a></li>
<li><a href="#gitops-installing-olm-operators-using-gitops_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations">Installing OLM Operators using Red Hat OpenShift GitOps</a>
<ul class="sectlevel2">
<li><a href="#installing-cluster-scoped-operators_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations">Installing cluster-scoped Operators</a></li>
<li><a href="#installing-namespace-scoped-operators_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations">Installing namepace-scoped Operators</a></li>
</ul>
</li>
</ul>
</div>
<div class="paragraph">
<p>With Red Hat OpenShift GitOps, you can configure Argo CD to recursively sync the content of a Git directory with an application that contains custom configurations for your cluster.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"><a class="anchor" href="#prerequisites_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You have logged in to the OpenShift Container Platform cluster as an administrator.</p>
</li>
<li>
<p>You have installed the Red Hat OpenShift GitOps Operator in your cluster.</p>
</li>
<li>
<p>You have logged into Argo CD instance.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-argo-cd-instance-to-manage-cluster-scoped-resourcesconfiguring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"><a class="anchor" href="#using-argo-cd-instance-to-manage-cluster-scoped-resourcesconfiguring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"></a>Using an Argo CD instance to manage cluster-scoped resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To manage cluster-scoped resources, update the existing <code>Subscription</code> object for the <code>gitops-title</code> Operator and add the namespace of the Argo CD instance to the <code>ARGOCD_CLUSTER_CONFIG_NAMESPACES</code> environment variable in the <code>spec</code> section.</p>
</div>
<div class="olist discrete">
<div class="title">Procedure</div>
<ol class="discrete">
<li>
<p>In the <strong>Administrator</strong> perspective of the web console, navigate to <strong>Operators</strong> → <strong>Installed Operators</strong> → <strong>Red Hat OpenShift GitOps</strong> → <strong>Subscription</strong>.</p>
</li>
<li>
<p>Click the <strong>Actions</strong> drop-down menu then click <strong>Edit Subscription</strong>.</p>
</li>
<li>
<p>On the <strong>openshift-gitops-operator</strong> Subscription details page, under the <strong>YAML</strong> tab, edit the <code>Subscription</code> YAML file by adding the namespace of the Argo CD instance to the <code>ARGOCD_CLUSTER_CONFIG_NAMESPACES</code> environment variable in the <code>spec</code> section:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">operators.coreos.com/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Subscription</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">openshift-gitops-operator</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">openshift-operators</span>
<span class="c1"># ...</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">config</span><span class="pi">:</span>
    <span class="na">env</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">ARGOCD_CLUSTER_CONFIG_NAMESPACES</span>
      <span class="na">value</span><span class="pi">:</span> <span class="s">openshift-gitops, &lt;list of namespaces of cluster-scoped Argo CD instances&gt;</span>
<span class="c1"># ...</span></code></pre>
</div>
</div>
</li>
<li>
<p>To verify that the Argo instance is configured with a cluster role to manage cluster-scoped resources, perform the following steps:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Navigate to <strong>User Management</strong> → <strong>Roles</strong> and from the <strong>Filter</strong>  drop-down menu select <strong>Cluster-wide Roles</strong>.</p>
</li>
<li>
<p>Search for the <code>argocd-application-controller</code> by using the <strong>Search by name</strong> field.</p>
<div class="paragraph">
<p>The <strong>Roles</strong> page displays the created cluster role.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Alternatively, in the OpenShift CLI, run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="go">oc auth can-i create oauth -n openshift-gitops --as system:serviceaccount:openshift-gitops:openshift-gitops-argocd-application-controller</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The output <code>yes</code> verifies that the Argo instance is configured with a cluster role to manage cluster-scoped resources. Else, check your configurations and take necessary steps as required.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="default-permissions-of-an-argocd-instance.adocconfiguring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"><a class="anchor" href="#default-permissions-of-an-argocd-instance.adocconfiguring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"></a>Default permissions of an Argocd instance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default Argo CD instance has the following permissions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Argo CD instance has the <code>admin</code> privileges to manage resources only in the namespace where it is deployed. For instance, an Argo CD instance deployed in the <strong>foo</strong> namespace has the <code>admin</code> privileges to manage resources only for that namespace.</p>
</li>
<li>
<p>Argo CD has the following cluster-scoped permissions because Argo CD requires cluster-wide <code>read</code> privileges on resources to function appropriately:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="pi">-</span> <span class="na">verbs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">get</span>
    <span class="pi">-</span> <span class="s">list</span>
    <span class="pi">-</span> <span class="s">watch</span>
   <span class="na">apiGroups</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">*'</span>
   <span class="na">resources</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">*'</span>
<span class="err"> </span><span class="pi">-</span> <span class="na">verbs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">get</span>
    <span class="pi">-</span> <span class="s">list</span>
   <span class="na">nonResourceURLs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">*'</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>You can edit the cluster roles used by the <code>argocd-server</code> and <code>argocd-application-controller</code> components where Argo CD is running such that the <code>write</code> privileges are limited to only the namespaces and resources that you wish Argo CD to manage.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc edit clusterrole argocd-server
<span class="gp">$</span><span class="w"> </span>oc edit clusterrole argocd-application-controller</code></pre>
</div>
</div>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="run-argo-cd-instance-on-cluster_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"><a class="anchor" href="#run-argo-cd-instance-on-cluster_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"></a>Running the Argo CD instance at the cluster-level</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default Argo CD instance and the accompanying controllers, installed by the Red Hat OpenShift GitOps Operator, can now run on the infrastructure nodes of the cluster by setting a simple configuration toggle.</p>
</div>
<div class="olist discrete">
<div class="title">Procedure</div>
<ol class="discrete">
<li>
<p>Label the existing nodes:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc label node &lt;node-name&gt; node-role.kubernetes.io/infra<span class="o">=</span><span class="s2">""</span></code></pre>
</div>
</div>
</li>
<li>
<p>Optional: If required, you can also apply taints and isolate the workloads on infrastructure nodes and prevent other workloads from scheduling on these nodes:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc adm taint nodes <span class="nt">-l</span> node-role.kubernetes.io/infra <span class="se">\</span>
<span class="nv">infra</span><span class="o">=</span>reserved:NoSchedule <span class="nv">infra</span><span class="o">=</span>reserved:NoExecute</code></pre>
</div>
</div>
</li>
<li>
<p>Add the <code>runOnInfra</code> toggle in the <code>GitOpsService</code> custom resource:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">pipelines.openshift.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">GitopsService</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">cluster</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">runOnInfra</span><span class="pi">:</span> <span class="no">true</span></code></pre>
</div>
</div>
</li>
<li>
<p>Optional: If taints have been added to the nodes, then add <code>tolerations</code> to the <code>GitOpsService</code> custom resource, for example:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml">  <span class="na">spec</span><span class="pi">:</span>
    <span class="na">runOnInfra</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">tolerations</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">effect</span><span class="pi">:</span> <span class="s">NoSchedule</span>
      <span class="na">key</span><span class="pi">:</span> <span class="s">infra</span>
      <span class="na">value</span><span class="pi">:</span> <span class="s">reserved</span>
    <span class="pi">-</span> <span class="na">effect</span><span class="pi">:</span> <span class="s">NoExecute</span>
      <span class="na">key</span><span class="pi">:</span> <span class="s">infra</span>
      <span class="na">value</span><span class="pi">:</span> <span class="s">reserved</span></code></pre>
</div>
</div>
</li>
<li>
<p>Verify that the workloads in the <code>openshift-gitops</code> namespace are now scheduled on the infrastructure nodes by viewing <strong>Pods</strong> &#8594; <strong>Pod details</strong> for any pod in the console UI.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Any <code>nodeSelectors</code> and <code>tolerations</code> manually added to the default Argo CD custom resource are overwritten by the toggle and <code>tolerations</code> in the <code>GitOpsService</code> custom resource.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>To learn more about taints and tolerations, see <a href="https://docs.openshift.com/container-platform/latest/nodes/scheduling/nodes-scheduler-taints-tolerations.html#nodes-scheduler-taints-tolerations">Controlling pod placement using node taints</a>.</p>
</li>
<li>
<p>For more information on infrastructure machine sets, see <a href="https://docs.openshift.com/container-platform/latest/machine_management/creating-infrastructure-machinesets.html#creating-infrastructure-machinesets">Creating infrastructure machine sets</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-an-application-by-using-the-argo-cd-dashboard_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"><a class="anchor" href="#creating-an-application-by-using-the-argo-cd-dashboard_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"></a>Creating an application by using the Argo CD dashboard</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Argo CD provides a dashboard which allows you to create applications.</p>
</div>
<div class="paragraph">
<p>This sample workflow walks you through the process of configuring Argo CD to recursively sync the content of the <code>cluster</code> directory to the <code>cluster-configs</code> application. The directory defines the OpenShift Container Platform web console cluster configurations that add a link to the <strong>Red Hat Developer Blog - Kubernetes</strong> under the <span class="image"><img src="data:image/jpg;base64,/9j/4QCLRXhpZgAATU0AKgAAAAgABgEPAAIAAAAIAAAAVgESAAMAAAABAAEAAAEaAAUAAAABAAAAXgEbAAUAAAABAAAAZgEoAAMAAAABAAIAAAExAAIAAAAVAAAAbgAAAABCZUZ1bmt5AAAAASwAAAABAAABLAAAAAFCZUZ1bmt5IFBob3RvIEVkaXRvcgD/4AAQSkZJRgABAQEBLAEsAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQIBAQEBAQIBAQECAgICAgICAgIDAwQDAwMDAwICAwQDAwQEBAQEAgMFBQQEBQQEBAT/2wBDAQEBAQEBAQIBAQIEAwIDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAT/wAARCAAgACADAREAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD+KegAoAKACgAoA/uU+J37BH/BDLTPjd+xX4f8J/sXftm6d4P+IXiXxTF8TtE1b9nP9rG01Hxxptl4D1fUdPW1trjTxqN7cQalHpl0w8Mq4jhS4kucWo3UAL8MP2CP+CGWqfG79tPw/wCLP2Lv2zdR8IfD3xN4Wi+GOh6T+zn+1jd6j4H0298B6RqOoLdW1vp51GyuJ9Sk1O6UeJlQSQvbyW2bUhqAP4aqACgD/UT+OXhb/goEP2lv+Cc9vrX7V/7GWrazq3xB8by+GrvSf2NfFdjpy3kfws8TSXF/dWLfE6SXVbc2rXkSmzudLWGa+t5nE6AW1AB8DPC3/BQJv2lv+Ci9vov7V/7GWk6zpPxB8ES+JbvVv2NfFd/pzXknws8MyW9/a2A+J0culW4tVs4m+2XOqLNNY3EyCBCbagD/AC7KACgAoAKAD9KAP//Z" alt="red hat applications menu icon" title="Red Hat applications"></span> menu in the web console, and defines a namespace <code>spring-petclinic</code> on the cluster.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Argo CD dashboard, click <strong>NEW APP</strong> to add a new Argo CD application.</p>
</li>
<li>
<p>For this workflow, create a <strong>cluster-configs</strong> application with the following configurations:</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Application Name</dt>
<dd>
<p><code>cluster-configs</code></p>
</dd>
<dt class="hdlist1">Project</dt>
<dd>
<p><code>default</code></p>
</dd>
<dt class="hdlist1">Sync Policy</dt>
<dd>
<p><code>Manual</code></p>
</dd>
<dt class="hdlist1">Repository URL</dt>
<dd>
<p><code><a href="https://github.com/redhat-developer/openshift-gitops-getting-started" class="bare">https://github.com/redhat-developer/openshift-gitops-getting-started</a></code></p>
</dd>
<dt class="hdlist1">Revision</dt>
<dd>
<p><code>HEAD</code></p>
</dd>
<dt class="hdlist1">Path</dt>
<dd>
<p><code>cluster</code></p>
</dd>
<dt class="hdlist1">Destination</dt>
<dd>
<p><code><a href="https://kubernetes.default.svc" class="bare">https://kubernetes.default.svc</a></code></p>
</dd>
<dt class="hdlist1">Namespace</dt>
<dd>
<p><code>spring-petclinic</code></p>
</dd>
<dt class="hdlist1">Directory Recurse</dt>
<dd>
<p><code>checked</code></p>
</dd>
</dl>
</div>
</li>
<li>
<p>Click <strong>CREATE</strong> to create your application.</p>
</li>
<li>
<p>Open the <strong>Administrator</strong> perspective of the web console and navigate to <strong>Administration</strong> &#8594; <strong>Namespaces</strong> in the menu on the left.</p>
</li>
<li>
<p>Search for and select the namespace, then enter <code>argocd.argoproj.io/managed-by=openshift-gitops</code> in the <strong>Label</strong> field so that the Argo CD instance in the <code>openshift-gitops</code> namespace can manage your namespace.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-an-application-by-using-the-oc-tool_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"><a class="anchor" href="#creating-an-application-by-using-the-oc-tool_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"></a>Creating an application by using the <code>oc</code> tool</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can create Argo CD applications in your terminal by using the <code>oc</code> tool.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Download <a href="https://github.com/redhat-developer/openshift-gitops-getting-started">the sample application</a>:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>git clone git@github.com:redhat-developer/openshift-gitops-getting-started.git</code></pre>
</div>
</div>
</li>
<li>
<p>Create the application:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc create <span class="nt">-f</span> openshift-gitops-getting-started/argo/app.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Run the <code>oc get</code> command to review the created application:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get application <span class="nt">-n</span> openshift-gitops</code></pre>
</div>
</div>
</li>
<li>
<p>Add a label to the namespace your application is deployed in so that the Argo CD instance in the <code>openshift-gitops</code> namespace can manage it:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc label namespace spring-petclinic argocd.argoproj.io/managed-by<span class="o">=</span>openshift-gitops</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synchronizing-your-application-application-with-your-git-repository_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"><a class="anchor" href="#synchronizing-your-application-application-with-your-git-repository_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"></a>Synchronizing your application with your Git repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can synchronize your application with your Git repository by modifying the synchronization policy for Argo CD. The policy modification automatically applies the changes in your cluster configurations from your Git repository to the cluster.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Argo CD dashboard, notice that the <strong>cluster-configs</strong> Argo CD application has the statuses <strong>Missing</strong> and <strong>OutOfSync</strong>. Because the application was configured with a manual sync policy, Argo CD does not sync it automatically.</p>
</li>
<li>
<p>Click <strong>SYNC</strong> on the <strong>cluster-configs</strong> tile, review the changes, and then click <strong>SYNCHRONIZE</strong>. Argo CD will detect any changes in the Git repository automatically. If the configurations are changed, Argo CD will change the status of the <strong>cluster-configs</strong> to <strong>OutOfSync</strong>. You can modify the synchronization policy for Argo CD to automatically apply changes from your Git repository to the cluster.</p>
</li>
<li>
<p>Notice that the <strong>cluster-configs</strong> Argo CD application now has the statuses <strong>Healthy</strong> and <strong>Synced</strong>. Click the <strong>cluster-configs</strong> tile to check the details of the synchronized resources and their status on the cluster.</p>
</li>
<li>
<p>Navigate to the OpenShift Container Platform web console and click <span class="image"><img src="data:image/jpg;base64,/9j/4QCLRXhpZgAATU0AKgAAAAgABgEPAAIAAAAIAAAAVgESAAMAAAABAAEAAAEaAAUAAAABAAAAXgEbAAUAAAABAAAAZgEoAAMAAAABAAIAAAExAAIAAAAVAAAAbgAAAABCZUZ1bmt5AAAAASwAAAABAAABLAAAAAFCZUZ1bmt5IFBob3RvIEVkaXRvcgD/4AAQSkZJRgABAQEBLAEsAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQIBAQEBAQIBAQECAgICAgICAgIDAwQDAwMDAwICAwQDAwQEBAQEAgMFBQQEBQQEBAT/2wBDAQEBAQEBAQIBAQIEAwIDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAT/wAARCAAgACADAREAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD+KegAoAKACgAoA/uU+J37BH/BDLTPjd+xX4f8J/sXftm6d4P+IXiXxTF8TtE1b9nP9rG01Hxxptl4D1fUdPW1trjTxqN7cQalHpl0w8Mq4jhS4kucWo3UAL8MP2CP+CGWqfG79tPw/wCLP2Lv2zdR8IfD3xN4Wi+GOh6T+zn+1jd6j4H0298B6RqOoLdW1vp51GyuJ9Sk1O6UeJlQSQvbyW2bUhqAP4aqACgD/UT+OXhb/goEP2lv+Cc9vrX7V/7GWrazq3xB8by+GrvSf2NfFdjpy3kfws8TSXF/dWLfE6SXVbc2rXkSmzudLWGa+t5nE6AW1AB8DPC3/BQJv2lv+Ci9vov7V/7GWk6zpPxB8ES+JbvVv2NfFd/pzXknws8MyW9/a2A+J0culW4tVs4m+2XOqLNNY3EyCBCbagD/AC7KACgAoAKAD9KAP//Z" alt="red hat applications menu icon" title="Red Hat applications"></span> to verify that a link to the <strong>Red Hat Developer Blog - Kubernetes</strong> is now present there.</p>
</li>
<li>
<p>Navigate to the <strong>Project</strong> page and search for the <code>spring-petclinic</code> namespace to verify that it has been added to the cluster.</p>
<div class="paragraph">
<p>Your cluster configurations have been successfully synchronized to the cluster.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="gitops-inbuilt-permissions-for-cluster-config_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"><a class="anchor" href="#gitops-inbuilt-permissions-for-cluster-config_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"></a>In-built permissions for cluster configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, the Argo CD instance has permissions to manage specific cluster-scoped resources such as cluster Operators, optional OLM Operators and user management.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Argo CD does not have cluster-admin permissions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Permissions for the Argo CD instance:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Resources</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Descriptions</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource Groups</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure the user or administrator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>operators.coreos.com</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional Operators managed by OLM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user.openshift.io</code> , <code>rbac.authorization.k8s.io</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Groups, Users and their permissions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>config.openshift.io</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control plane Operators managed by CVO used to configure cluster-wide build configuration, registry configuration and scheduler policies</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>storage.k8s.io</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Storage</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>console.openshift.io</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Console customization</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="gitops-additional-permissions-for-cluster-config_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"><a class="anchor" href="#gitops-additional-permissions-for-cluster-config_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"></a>Adding permissions for cluster configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can grant permissions for an Argo CD instance to manage cluster configuration. Create a cluster role with additional permissions and then create a new cluster role binding to associate the cluster role with a service account.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to the OpenShift Container Platform web console as an admin.</p>
</li>
<li>
<p>In the web console, select <strong>User Management</strong> &#8594; <strong>Roles</strong> &#8594; <strong>Create Role</strong>. Use the following <code>ClusterRole</code> YAML template to add rules to specify the additional permissions.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ClusterRole</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">secrets-cluster-role</span>
<span class="na">rules</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">apiGroups</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">"</span><span class="pi">]</span>
  <span class="na">resources</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">secrets"</span><span class="pi">]</span>
  <span class="na">verbs</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">*"</span><span class="pi">]</span></code></pre>
</div>
</div>
</li>
<li>
<p>Click <strong>Create</strong> to add the cluster role.</p>
</li>
<li>
<p>Now create the cluster role binding. In the web console, select <strong>User Management</strong> &#8594; <strong>Role Bindings</strong> &#8594; <strong>Create Binding</strong>.</p>
</li>
<li>
<p>Select <strong>All Projects</strong> from the <strong>Project</strong> drop-down.</p>
</li>
<li>
<p>Click <strong>Create binding</strong>.</p>
</li>
<li>
<p>Select <strong>Binding type</strong> as <strong>Cluster-wide role binding (ClusterRoleBinding)</strong>.</p>
</li>
<li>
<p>Enter a unique value for the <strong>RoleBinding name</strong>.</p>
</li>
<li>
<p>Select the newly created cluster role or an existing cluster role from the drop down list.</p>
</li>
<li>
<p>Select the <strong>Subject</strong> as <strong>ServiceAccount</strong> and the provide the <strong>Subject namespace</strong> and <strong>name</strong>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong>Subject namespace</strong>: <code>openshift-gitops</code></p>
</li>
<li>
<p><strong>Subject name</strong>: <code>openshift-gitops-argocd-application-controller</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>Create</strong>. The YAML file for the <code>ClusterRoleBinding</code> object is as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">kind</span><span class="pi">:</span> <span class="s">ClusterRoleBinding</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">cluster-role-binding</span>
<span class="na">subjects</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">kind</span><span class="pi">:</span> <span class="s">ServiceAccount</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">openshift-gitops-argocd-application-controller</span>
    <span class="na">namespace</span><span class="pi">:</span> <span class="s">openshift-gitops</span>
<span class="na">roleRef</span><span class="pi">:</span>
  <span class="na">apiGroup</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io</span>
  <span class="na">kind</span><span class="pi">:</span> <span class="s">ClusterRole</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">admin</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="gitops-installing-olm-operators-using-gitops_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"><a class="anchor" href="#gitops-installing-olm-operators-using-gitops_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"></a>Installing OLM Operators using Red Hat OpenShift GitOps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Red Hat OpenShift GitOps with cluster configurations manages specific cluster-scoped resources and takes care of installing cluster Operators or any namespace-scoped OLM Operators.</p>
</div>
<div class="paragraph">
<p>Consider a case where as a cluster administrator, you have to install an OLM Operator such as Tekton. You use the OpenShift Container Platform web console to manually install a Tekton Operator or the OpenShift CLI to manually install a Tekton subscription and Tekton Operator group on your cluster.</p>
</div>
<div class="paragraph">
<p>Red Hat OpenShift GitOps places your Kubernetes resources in your Git repository. As a cluster administrator, use Red Hat OpenShift GitOps to manage and automate the installation of other OLM Operators without any manual procedures. For example, after you place the Tekton subscription in your Git repository by using Red Hat OpenShift GitOps, the Red Hat OpenShift GitOps automatically takes this Tekton subscription from your Git repository and installs the Tekton Operator on your cluster.</p>
</div>
<div class="sect2">
<h3 id="installing-cluster-scoped-operators_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"><a class="anchor" href="#installing-cluster-scoped-operators_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"></a>Installing cluster-scoped Operators</h3>
<div class="paragraph">
<p>Operator Lifecycle Manager (OLM) uses a default <code>global-operators</code> Operator group in the <code>openshift-operators</code> namespace for cluster-scoped Operators. Hence you do not have to manage the <code>OperatorGroup</code> resource in your Gitops repository. However, for namespace-scoped Operators, you must manage the <code>OperatorGroup</code> resource in that namespace.</p>
</div>
<div class="paragraph">
<p>To install cluster-scoped Operators, create and place the <code>Subscription</code> resource of the required Operator in your Git repository.</p>
</div>
<div class="listingblock">
<div class="title">Example: Grafana Operator subscription</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">operators.coreos.com/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Subscription</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">grafana</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">channel</span><span class="pi">:</span> <span class="s">v4</span>
  <span class="na">installPlanApproval</span><span class="pi">:</span> <span class="s">Automatic</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">grafana-operator</span>
  <span class="na">source</span><span class="pi">:</span> <span class="s">redhat-operators</span>
  <span class="na">sourceNamespace</span><span class="pi">:</span> <span class="s">openshift-marketplace</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="installing-namespace-scoped-operators_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"><a class="anchor" href="#installing-namespace-scoped-operators_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations"></a>Installing namepace-scoped Operators</h3>
<div class="paragraph">
<p>To install namespace-scoped Operators, create and place the <code>Subscription</code> and <code>OperatorGroup</code> resources of the required Operator in your Git repository.</p>
</div>
<div class="listingblock">
<div class="title">Example: Ansible Automation Platform Resource Operator</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="c1"># ...</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Namespace</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="s">openshift.io/cluster-monitoring</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">ansible-automation-platform</span>
<span class="c1"># ...</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">operators.coreos.com/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">OperatorGroup</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">ansible-automation-platform-operator</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">ansible-automation-platform</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">targetNamespaces</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">ansible-automation-platform</span>
<span class="c1"># ...</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">operators.coreos.com/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Subscription</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">ansible-automation-platform</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">ansible-automation-platform</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">channel</span><span class="pi">:</span> <span class="s">patch-me</span>
  <span class="na">installPlanApproval</span><span class="pi">:</span> <span class="s">Automatic</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">ansible-automation-platform-operator</span>
  <span class="na">source</span><span class="pi">:</span> <span class="s">redhat-operators</span>
  <span class="na">sourceNamespace</span><span class="pi">:</span> <span class="s">openshift-marketplace</span>
<span class="c1"># ...</span></code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When deploying multiple Operators using Red Hat OpenShift GitOps, you must create only a single Operator group in the corresponding namespace. If more than one Operator group exists in a single namespace, any CSV created in that namespace transition to a <code>failure</code> state with the <code>TooManyOperatorGroups</code> reason. After the number of Operator groups in their corresponding namespaces reaches one, all the previous <code>failure</code> state CSVs transition to <code>pending</code> state. You must manually approve the pending install plan to complete the Operator installation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
      </div>
    </div>
  </div>
  <script src="https://assets.openshift.net/content/modernizr.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/subdomain.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/nav-tertiary.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/bootstrap-offcanvas.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/reformat-html.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/hc-search.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/page-loader.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/clipboard.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/collapsible.js" type="text/javascript"></script>
  <script>
  var dk = 'openshift-gitops';
  var version = 'Branch Build';

  var distros = {
    'openshift-origin': ['docs_origin', version],
    // specific labels are used for OSD instead of the URL filter, due to its unusual URL structure; assume v4
    'openshift-dedicated': ['docs_dedicated_v4'],
    'openshift-online': ['docs_online', version],
    'openshift-enterprise': ['docs_cp', version],
    'openshift-aro' : ['docs_aro', version],
    'openshift-rosa' : ['docs_rosa'],
    'openshift-acs' : ['docs_acs', version],
    'openshift-serverless' : ['docs_serverless', version]
  };

  // only OSD v3 docs have the version variable specified
  if (dk == "openshift-dedicated" && version == "3") {
    distros['openshift-dedicated'] = ['docs_dedicated_v3']
  }

  distros[dk] ? hcSearchCategory.apply(null, distros[dk]) : hcSearchCategory("docs");
  </script>
  <script type="text/javascript">
  /*<![CDATA[*/
  $(document).ready(function() {
    $("[id^='topicGroup']").on('show.bs.collapse', function(event) {
      if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
        $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
      }
    });
    $("[id^='topicGroup']").on('hide.bs.collapse', function(event) {
      if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
        $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
      }
    });
    $("[id^='topicSubGroup']").on('show.bs.collapse', function() {
      $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });
    $("[id^='topicSubGroup']").on('hide.bs.collapse', function() {
      $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });
    $("[id^='topicSubSubGroup']").on('show.bs.collapse', function() {
      $(this).parent().find("[id^='ssgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });
    $("[id^='topicSubSubGroup']").on('hide.bs.collapse', function() {
      $(this).parent().find("[id^='ssgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });

    const collapsibleContent = document.getElementsByTagName("details");
    for (var i = 0; i < collapsibleContent.length; i++) {
      collapsibleContent[i].setAttribute("open", "");
    }

  });
  /*]]>*/
  </script>

  <footer id="rh">

    <div class="container">
        <div class="row">

            <div class="col-sm-2">
                <img src="https://assets.openshift.com/hubfs/images/logos/Logo-RedHat-A-Reverse-RGB.svg" class="img-fluid" alt="Red Hat" style="height: 30px;">
            </div>

            <div class="col-sm-3">
              <p class="text-nowrap">Copyright © 2023 Red Hat, Inc.</p>
            </div>



            <div class="col">
                <nav class="nav">
                    <a target="_blank" href="https://www.redhat.com/en/about/privacy-policy" class="nav-link">Privacy statement</a>
                    <a target="_blank" href="https://www.openshift.com/legal/terms/" class="nav-link">Terms of use</a>
                    <a target="_blank" href="https://www.redhat.com/en/about/all-policies-guidelines" class="nav-link">All policies and guidelines</a>
                    <a id="teconsent"></a>
                </nav>
            </div>
        </div>
    </div>
</footer>
<div id="consent_blackbar" style="z-index: 100; position: fixed"></div>



<!-- Adobe DTM -->
<script type="text/javascript">
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
   _satellite.pageBottom();
}
</script>
<!-- End Adobe DTM -->

  <!-- adjust page css based on breadcrumb and/or resize -->
  <script type="text/javascript">
    window.addEventListener('DOMContentLoaded', () => {
      if ($(window).width() >= 1008) {
        adjustSide();
        adjustToc();
        adjustMain();
      }
    });

    window.addEventListener('resize', () => {
      if ($(window).width() >= 1008) {
        adjustSide();
        adjustToc();
        adjustMain();
      } else if ($(window).width() < 1008) {
        sidebar.classList.remove('wide');
        document.querySelector('#hc-search').classList.remove('wide');
        if (sidebar.classList.contains('open')) {
          sidebar.style.display = 'block';
        } else {
          sidebar.style.display = 'none';
        }
        document.querySelector('.main').style.paddingTop = '0px';
      }
    });

    function adjustSide() {
      sidebar.classList.add('wide');
      document.querySelector('#hc-search').classList.add('wide');
      sidebar.style.display = 'block';
      document.querySelector('.sidebar').style.top = parseInt((document.querySelector('.breadcrumb').offsetHeight + 125), 10) + "px";
      document.querySelector('#hc-search').style.top = parseInt((document.querySelector('.breadcrumb').offsetHeight + 95), 10) + "px";
    }

    function adjustToc() {
      if (document.querySelector('#toc') !== null) {
        document.querySelector('#toc').style.top = parseInt((document.querySelector('.breadcrumb').offsetHeight + 90), 10) + "px";
      }
    }

    function adjustMain() {
      document.querySelector('html').style.scrollPaddingTop = parseInt((document.querySelector('.breadcrumb').offsetHeight + 90), 10) + "px";
      document.querySelector('.main').style.paddingTop = parseInt((document.querySelector('.breadcrumb').offsetHeight - 70), 10) + "px";
    }

  </script>

  <!-- remove toc active class when page is loaded -->
  <script type="text/javascript">
    window.addEventListener('DOMContentLoaded', () => {
      var tocItems = $("#toc a");

      for (let i = 0; i < tocItems.length; i++) {
        tocItems[i].classList.remove("toc-active");
      }
    })
  </script>

  <!-- maintain sidebar scroll position between page loads -->
  <script type="text/javascript">
    let sidebar = document.querySelector(".sidebar");
    let scrolltop = localStorage.getItem("sidebar-scroll");

    if (scrolltop == null) {
      sidebar.scrollTop = parseInt(top, 10);
    }

    window.addEventListener("beforeunload", () => {
      localStorage.setItem("sidebar-scroll", sidebar.scrollTop);
    });

    window.addEventListener('load', () => {
      sidebar.scrollTo(0, scrolltop)
    })
  </script>

  <!-- open/close the nav -->
  <script type="text/javascript">
    function closeNav() {
      let sidebar = document.querySelector(".sidebar");
      sidebar.style.display = "none";
      sidebar.classList.remove('open');
    }

    function openNav() {
      let sidebar = document.querySelector(".sidebar");
      let hc_search = document.querySelector('#hc-search');
      sidebar.style.display = "block";
      sidebar.style.top = "0px";
      hc_search.style.top = 'unset';
      sidebar.classList.add('open');
    }
  </script>

  <!-- clear and add toc-active to clicked toc link -->
  <script type="text/javascript">
  $("#toc a").click(function() {
    var tocItems = $("#toc a");
    for (let i = 0; i < tocItems.length; i++) {
      tocItems[i].classList.remove("toc-active");
    }
    this.classList.add("toc-active");
  });
  </script>

  <!-- update active toc class when mouse scrolls -->
  <script type="text/javascript">
    window.addEventListener('DOMContentLoaded', () => {
      window.addEventListener("wheel", () => {

        const ioConfiguration = {
          "rootMargin": "-120px 0px -400px 0px",
          "threshold": 0
        };

        const observer = new IntersectionObserver(setCurrent, ioConfiguration, entries => {
          entries.forEach(entry => {
            var id = entry.target.getAttribute('id');
            //fight with js
            document.querySelector(`#toc li a[href="#${id}"]`).classList.remove('toc-active');
          });
        });

        //track all h1-4 headings that have an id
        document.querySelectorAll('.main h2[id], .main h3[id]').forEach((h) => {
          observer.observe(h);
        });

        //runs when the IntersectionObserver fires
        function setCurrent(e) {
          var allTocLinks = document.querySelectorAll("#toc li a");
          if (allTocLinks !== undefined) {
            e.map(i => {
              if (i.isIntersecting && i.intersectionRatio >= 1) {
                allTocLinks.forEach(link => link.classList.remove("toc-active"));
                document.querySelector(`#toc li a[href="#${i.target.id}"]`).classList.add('toc-active')
              }
            })
          }
        };

        //make clicked toc item active and stop IntersectionObserver
        $("#toc a").click(function() {
          //stop tracking all h1-4 headings that have an id
          document.querySelectorAll('.main h2[id], .main h3[id]').forEach((h) => {
            observer.unobserve(h);
          });
          var tocItems = $("#toc a");
          if (tocItems !== undefined) {
            for (let i = 0; i < tocItems.length; i++) {
              tocItems[i].classList.remove("toc-active");
            };
            this.classList.add("toc-active");
          }
        })
      })
    })
  </script>

  <!--handle page scroll top and bottom, add toc-active -->
  <script type="text/javascript">
    document.addEventListener('scroll', () => {
      //scroll to bottom
      if(document.documentElement.scrollHeight === window.pageYOffset + window.innerHeight) {
        var tocItems = $("#toc a");
        for (let i = 0; i < tocItems.length; i++) {
          tocItems[i].classList.remove("toc-active")
          };
          tocItems[tocItems.length - 1].classList.add("toc-active");
        };
      //scroll to top
      if(window.pageYOffset === 0) {
        var tocItems = $("#toc a");
        for (let i = 0; i < tocItems.length; i++) {
          tocItems[i].classList.remove("toc-active");
          };
          tocItems[0].classList.add("toc-active");
        };
      })
  </script>

  <!--adjust sidebar and toc when footer is displayed -->
  <script type="text/javascript">
    sidebar = document.querySelector('.sidebar')
    toc = document.querySelector('#toc')
    main = document.querySelector('.main')
    okd_footer = document.querySelector('.footer-origin-docs')

    //handle short pages
    if (window.innerHeight === document.documentElement.scrollHeight) {
      //sidebar
      if (sidebar !== null && okd_footer == null) {
        sidebar.style.marginBottom = "38px";
        main.style.marginBottom = "35px";
      };
      //okd sidebar
      if(sidebar !== null && okd_footer !== null) {
        sidebar.style.marginBottom = "176px";
        main.style.marginBottom = "135px";
      }
    };

    //handle scrolling pages
    document.addEventListener('scroll', () => {
      //scroll to bottom
      if ($(window).width() >= 1008) {
        if(sidebar !== null) {
          //pages with multiple toc entries
          if(document.documentElement.scrollHeight === window.pageYOffset + window.innerHeight) {
              //sidebar
              if (sidebar !== null && okd_footer == null){
                sidebar.style.marginBottom = "38px";
                main.style.marginBottom = "35px";
              };
              //toc
              if (toc !== null && okd_footer == null){
                toc.style.bottom = "35px";
              };
              //okd sidebar
              if(sidebar !== null && okd_footer !== null) {
                sidebar.style.marginBottom = "176px";
                main.style.marginBottom = "135px";
              };
              //okd toc
              if (toc !== null && okd_footer !== null){
                toc.style.bottom = "175px";
              };
            };
          if(document.documentElement.scrollHeight != window.pageYOffset + window.innerHeight) {
            sidebar.style.marginBottom = "0px";
            if (toc !== null) {
              toc.style.bottom = "0px";
            }
          }
        }
      }
    })
  </script>

  <!-- adjust alerts on mobile -->
  <script type="text/javascript">
    alert = document.querySelector('#support-alert')
    window.addEventListener("wheel", () => {
      if ($(window).width() < 1008) {
        //adjust alert
        if(window.pageYOffset > 0) {
          if(alert !== null) {
            document.querySelector('#support-alert').style.position = "fixed";
            document.querySelector('#support-alert').style.bottom = "0px";
            document.querySelector('#support-alert').style.margin = "5px";
            document.querySelector('#support-alert').style.zIndex = "9999999";
          }
        }
      }
   });
    window.addEventListener('resize', () => {
      if ($(window).width() >= 1008) {
        if(alert !== null) {
          document.querySelector('#support-alert').style.removeProperty('position');
          document.querySelector('#support-alert').style.removeProperty('bottom');
          document.querySelector('#support-alert').style.removeProperty('margin');
          document.querySelector('#support-alert').style.removeProperty('zIndex');
        }
      }
    })
  </script>

</body>
</html>